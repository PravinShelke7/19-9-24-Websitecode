Imports System.Data
Imports System.Data.OleDb
Imports System
Imports M1SubGetData
Imports M1SubUpInsData
Imports System.Collections
Imports System.IO.StringWriter
Imports System.Math
Imports System.Web.UI.HtmlTextWriter
Partial Class Pages_Market1_Tools_Tool
    Inherits System.Web.UI.Page

#Region "Browser Refresh Check"
    Dim objRefresh As zCon.Net.Refresh

    Protected Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreInit
        objRefresh = New zCon.Net.Refresh("_PAGES_MARKET1_TOOLS_TOOL")
    End Sub

    Protected Sub Page_PreRender(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.PreRender
        objRefresh.Render(Page)
    End Sub

#End Region

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Try
            If Session("Back") = Nothing Then
                Dim obj As New CryptoHelper
                Response.Redirect("../Errors/Error.aspx?ErrorCode=" + obj.Encrypt("ALDE112") + "")
            End If

            If Not IsPostBack Then
                lblTag.Text = "Copyright 1997 - " + Now.Year().ToString() + " Savvypack Corporation."
                hidBaseRpt.Value = "0"
                hidPropRpt.Value = "0"
                'GetPCases()
                ViewState("Edit") = "N"
                If Session("INTUSR") = "Y" Then
                    btnPivotReport.Visible = True
                    btnCreateSpecialReport.Visible = True
                Else
                    btnPivotReport.Visible = True
		    btnCreateSpecialReport.Visible = False
                End If
            End If
            GetPReportsDetails()

        Catch ex As Exception
            lblError.Text = "Error:Page_Load" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub GetPCases()
        Dim ds As New DataSet
        Dim objeGetData As New M1SubGetData.Selectdata()
        Try
            ds = objeGetData.GetUserCustomReports(Session("UserId").ToString())
            Session("UserReport") = ds
            'With ddlPCases
            '    .DataSource = ds
            '    .DataTextField = "REPORTDES"
            '    .DataValueField = "USERREPORTID"
            '    .DataBind()
            'End With
        Catch ex As Exception
            lblError.Text = "Error:GetReportDetails:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub GetPReportsDetails()
        Dim objGetData As New Selectdata()
        Dim ds As New DataSet()
        Try
            ' ds = objGetData.GetUserCustomReports(Session("UserId"))


            'With ddlPCase
            '    .DataSource = ds
            '    .DataTextField = "REPORTDES"
            '    .DataValueField = "USERREPORTID"
            '    .DataBind()
            '    .Font.Size = 8
            'End With

            ds = objGetData.GetUserCustomReportsForSub(Session("UserId"), Session("M1ServiceID"), "")

            If ds.Tables(0).Rows.Count <= 0 Then

                lnkReports.Visible = False
                lblPCase.Visible = True
                btnEdit.Enabled = False
                btnCopy.Enabled = False
                btnDelete.Enabled = False

            Else
                btnEdit.Enabled = True
                btnCopy.Enabled = True
                btnDelete.Enabled = True
                lblPCase.Visible = False
                lnkReports.Visible = True
            End If
        Catch ex As Exception
            lblError.Text = "Error:GetPCaseDetails:" + ex.Message.ToString() + ""
        End Try
    End Sub

    Protected Sub btnSubmitt_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSubmitt.Click
        Dim ColCnt As String = String.Empty
        Dim RowCnt As String = String.Empty
        Dim ReportName As String = String.Empty
        Dim objUpIns As New UpdateInsert()
        Dim objGetData As New Selectdata()
        Dim ReportId As String = String.Empty
        Dim filterCnt As String = String.Empty
        Try
            ColCnt = txtCol.Text.Trim()
            RowCnt = txtRw.Text.Trim()
            filterCnt = txtFilter.Text.Trim()
            ReportName = txtRptName.Text.Trim()

            hidReportType.Value = "MIXED"
            If Not objRefresh.IsRefresh Then
                If hidPropRpt.Value <> "0" Then
                    ReportId = objUpIns.EditUSERReportDetTemp(hidPropRpt.Value, txtRptName.Text, txtFilter.Text.ToString(), txtRw.Text.ToString(), txtCol.Text.ToString(), "MIXED", "", Session("UserID").ToString(), "", "Null", "Null", hidRowC.Value, hidColumnC.Value, hidFilterC.Value)
                End If

                SetReportFrameWorkTemp(RowCnt, ColCnt, txtFilter.Text, ReportId)
                hidRowC.Value = "N"
                hidColumnC.Value = "N"
                hidFilterC.Value = "N"
            End If
        Catch ex As Exception
            lblError.Text = "Error:btnSubmitt_Click " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetReportFrameWork(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRows = objGetData.GetUsersReportRows(RptID)
            dsCol = objGetData.GetUsersReportColumns(RptID)
            dsFilter = objGetData.GetUsersReportFilters(RptID)

            dvCol = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()

                        Link.CssClass = "LinkM"

                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            ' If Flag Then
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink



                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        'If Flag Then
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                        'End If
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            dv = dsRows.Tables(0).DefaultView
            For i = 1 To RowCnt
                Tr = New TableRow
                For j = 0 To ColCnt

                    If j = 0 Then
                        Td = New TableCell()
                        Link = New HyperLink

                        Link.Text = "Row_" + i.ToString()

                        Link.ID = "Row_" + i.ToString()
                        Link.CssClass = "LinkM"
                        hyd = New HiddenField
                        hyd.ID = "Row_ID_" + i.ToString()


                        dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTROWID").ToString()
                            'If Flag Then
                            If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                Link.Text = dt.Rows(0).Item("ROWVALUE").ToString() + " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                            End If

                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetRowLink(i, Link, RptID, hyd.ID, hyd.Value)


                        Td.Controls.Add(Link)
                        Td.Controls.Add(hyd)
                        Td.Style.Add("text-align", "Left")
                        Td.Style.Add("padding-left", "5px")
                        HeaderTdWLinkSetting(Td, "150px", "", "1")
                    Else
                        Td = New TableCell()
                        Td.Text = "&nbsp;"
                        HeaderTdSetting(Td, "150px", "", "1")
                        Td.CssClass = "AlterNateColor2"
                    End If
                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Tr.Controls.Add(Td)
                Next
                Tr.Height = 30
                tblCAGR.Controls.Add(Tr)
            Next


        Catch ex As Exception
            lblError.Text = "Error:SetReportFrameWork " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetSpecialReportFrameWork(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Try

            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRows = objGetData.GetUsersReportRows(RptID)
            dsCol = objGetData.GetUsersReportColumns(RptID)
            dsFilter = objGetData.GetUsersReportFilters(RptID)

            dvCol = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()

                        Link.CssClass = "LinkM"

                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            ' If Flag Then
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink



                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        'If Flag Then
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                        'End If
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 1
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        Else
                            lbl.Text = "GRAND TOTAL"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                lbl.Text = " (" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        Else
                            Td.Style.Add("text-align", "Right")
                            Td.Style.Add("padding-right", "5px")
                            Td.CssClass = "AlterNateColor2"
                        End If

                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next


            For i = 1 To dsRows.Tables(0).Rows.Count
                Tr = New TableRow
                For j = 0 To ColCnt

                    If j = 0 Then
                        Td = New TableCell()
                        lbl = New Label
                        dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                lbl.Text = dt.Rows(0).Item("ROWVALUE").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                            End If
                        End If

                        'Td.Font.Size = 8
                        'Td.Font.Bold = False
                        lbl.CssClass = "Label"
                        Td.Controls.Add(lbl)
                        Td.Style.Add("text-align", "Left")
                        Td.Style.Add("padding-left", "5px")
                        HeaderTdWLinkSetting(Td, "150px", "", "1")
                    Else
                        Td = New TableCell()
                        Td.Text = "&nbsp;"
                        HeaderTdSetting(Td, "150px", "", "1")
                        Td.CssClass = "AlterNateColor2"
                    End If
                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Tr.Controls.Add(Td)
                Next
                Tr.Height = 30
                tblCAGR.Controls.Add(Tr)
            Next


        Catch ex As Exception
            lblError.Text = "Error:SetReportFrameWork " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub GetFilterLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/FilterSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=" + Link.ClientID + "&hidId=" + hidId + "&isTemp=Y"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetColLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String
        Try
            Path = "../PopUp/ColSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=" + Link.ClientID + "&hidId=" + hidId + "&isTemp=Y"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub GetRowLink(ByVal Seq As String, ByVal Link As HyperLink, ByVal RptId As String, ByVal hidId As String, ByVal hidValue As String)
        Dim Path As String

        Dim RowVal2D As String = String.Empty
        Dim RegionSetId As String = String.Empty
        Dim Curr As String = String.Empty


        Try

            Path = "../PopUp/RowSelector.aspx?RptId=" + RptId + "&Seq=" + Seq.ToString() + "&Id=" + Link.ClientID + "&hidId=" + hidId + "&isTemp=Y"
            Link.NavigateUrl = "javascript:ShowPopWindow('" + Path + "','" + hidId + "')"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub HeaderTdSetting(ByVal Td As TableCell, ByVal Width As String, ByVal HeaderText As String, ByVal ColSpan As String)
        Try
            If HeaderText <> "" Then
                Td.Text = HeaderText
            End If

            Td.ColumnSpan = ColSpan
            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.CssClass = "TdHeading"
            Td.Height = 20
            Td.Font.Size = 10
            Td.Font.Bold = True
            Td.HorizontalAlign = HorizontalAlign.Center



        Catch ex As Exception
            lblError.Text = "Error:HeaderTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub HeaderTdWLinkSetting(ByVal Td As TableCell, ByVal Width As String, ByVal HeaderText As String, ByVal ColSpan As String)
        Try
            Td.ColumnSpan = ColSpan
            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.CssClass = "TdHeading"
            Td.Height = 20
            Td.Font.Size = 10
            Td.Font.Bold = True
            Td.HorizontalAlign = HorizontalAlign.Center



        Catch ex As Exception
            lblError.Text = "Error:HeaderTdSetting:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub InnerTdSetting(ByVal Td As TableCell, ByVal Width As String, ByVal Align As String)
        Try

            If Width <> "" Then
                Td.Style.Add("width", Width)
            End If
            Td.Style.Add("text-align", Align)
            If Align = "Left" Then
                Td.Style.Add("padding-left", "5px")
            End If
            If Align = "Right" Then
                Td.Style.Add("padding-right", "5px")
            End If
        Catch ex As Exception
            lblError.Text = "Error:InnerTdSetting:" + ex.Message.ToString()
        End Try
    End Sub


    Protected Sub btnEdit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnEdit.Click
        Try

            'divCreate.Visible = False
            'divCreateSpecial.Visible = False
            If hidPropRpt.Value = "0" Then
                Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Please select Proprietary Report');", True)
            Else
                GetReportDetails(hidPropRpt.Value)
                btnAddNew.Visible = False
                'divCreate.Visible = True
                EnableDisable("ED")
                Session("EDType") = "ED"
            End If
            lnkReports.Text = hidPropRptDes.Value




        Catch ex As Exception
            lblError.Text = "Error:btnEdit_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub GetReportDetails(ByVal RptID As String)
        ' Dim RptID As String = String.Empty
        Dim dsReport As New DataSet
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim objGetData As New M1SubGetData.Selectdata()
        Dim objUpdateData As New M1SubUpInsData.UpdateInsert()
        Try
            objUpdateData.SaveUserTempReports(RptID)

            dsReport = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            If dsReport.Tables(0).Rows(0)("RPTTYPE").ToString() = "UNIFORM" Then
                ddlSpecialType.Attributes.Add("onChange", "rowChange();")
                txtSpecialCols.Attributes.Add("onChange", "colChange();")
                txtSpecialFilters.Attributes.Add("onChange", "filterChange();")

                txtSpecialReportName.Text = dsReport.Tables(0).Rows(0)("REPORTNAME").ToString()
                txtSpecialCols.Text = dsCol.Tables(0).Rows.Count.ToString()
                txtSpecialFilters.Text = dsFilter.Tables(0).Rows.Count.ToString()
                divCreateSpecial.Visible = True
                BindRegionSet()
                BindUnits()

                ddlUnits.SelectedValue = dsRows.Tables(0).Rows(0)("UNITID").ToString()
                If dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "REGION" Then
                    ddlSpecialType.SelectedValue = "REGION"
                    packgroup.Visible = False
                    rowRegions.Visible = False
                    prodGroup.Visible = False
                    regionset.Visible = True
                    ddlRegionSet.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PACKGRP" Then
                    ddlSpecialType.SelectedValue = "PACKGRP"
                    regionset.Visible = False
                    packgroup.Visible = True
                    rowRegions.Visible = False
                    prodGroup.Visible = False
                    BindPackGroups()
                    ddlPackageGrp.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PROD" Then
                    ddlSpecialType.SelectedValue = "PROD"
                    regionset.Visible = False
                    packgroup.Visible = False
                    rowRegions.Visible = False
                    prodGroup.Visible = False
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PACK" Then
                    ddlSpecialType.SelectedValue = "PACK"
                    regionset.Visible = False
                    packgroup.Visible = False
                    rowRegions.Visible = False
                    prodGroup.Visible = False
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "MAT" Then
                    ddlSpecialType.SelectedValue = "MAT"
                    regionset.Visible = False
                    packgroup.Visible = False
                    rowRegions.Visible = False
                    prodGroup.Visible = False
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "GROUP" Then
                    ddlSpecialType.SelectedValue = "GROUP"
                    regionset.Visible = False
                    packgroup.Visible = False
                    prodGroup.Visible = True
                    rowRegions.Visible = False
                    BindProdGroups()
                    ddlProdGrp.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "CNTRY" Then
                    ddlSpecialType.SelectedValue = "CNTRY"
                    rowRegions.Visible = True
                    packgroup.Visible = False
                    prodGroup.Visible = False
                    regionset.Visible = True
                    ddlRegionSet.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                    BindRegions()
                    ddlRegions.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONID").ToString()
                    ddlRegions.Enabled = True
                End If
                'txtSpecialCols.Enabled = False
                'txtSpecialFilters.Enabled = False
                ddlSpecialType.Enabled = True
                ddlRegionSet.Enabled = True
                ddlUnits.Enabled = True
                btnSpecialSubmit.Visible = True
                btnSpecialSubmit.Enabled = True
                SetSpecialReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtSpecialCols.Text.Trim(), txtSpecialFilters.Text, RptID)

            ElseIf dsReport.Tables(0).Rows(0)("RPTTYPE").ToString() = "PIVOT" Then
                ViewState("Edit") = "N"
                ddlPivotType.Attributes.Add("onChange", "rowChange();")
                txtPivotCols.Attributes.Add("onChange", "colChange();")
                ddlPivotFilters.Attributes.Add("onChange", "filterChange();")

                txtPivotReportName.Text = dsReport.Tables(0).Rows(0)("REPORTNAME").ToString()
                txtPivotCols.Text = dsCol.Tables(0).Rows.Count.ToString()
                ddlPivotFilters.SelectedValue = dsFilter.Tables(0).Rows.Count
                divPivot.Visible = True
                BindRegionSet()
                BindUnits()

                ddlPivotUnit.SelectedValue = dsRows.Tables(0).Rows(0)("UNITID").ToString()
                ddlPivotType.Enabled = True
                ddlPivotRegionSet.Enabled = True
                ddlPivotUnit.Enabled = True
                btnPivotSubmit.Visible = True
                btnPivotSubmit.Enabled = True

                If dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PACKGRP" Then
                    ddlPivotType.SelectedValue = "PACKGRP"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = True
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    BindPackGroups()
                    ddlPackageGrp.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PROD" Then
                    ddlPivotType.SelectedValue = "PROD"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = False
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    SetPivotProdReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "PACK" Then
                    ddlPivotType.SelectedValue = "PACK"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = False
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    SetPivotPackReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "MAT" Then
                    ddlPivotType.SelectedValue = "MAT"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = False
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    SetPivotMatReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "COMPONENT" Then
                    ddlPivotType.SelectedValue = "COMPONENT"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = False
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    SetPivotCompReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "MATGRP" Then

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "GROUP" Then
                    ddlPivotType.SelectedValue = "GROUP"
                    Pivotregionset.Visible = False
                    Pivotpackgroup.Visible = False
                    PivotprodGroup.Visible = True
                    PivotrowRegions.Visible = False
                    BindProdGroups()
                    ddlPivotProdGrp.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                    SetPivotGrpReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                ElseIf dsReport.Tables(0).Rows(0)("RPTTYPEDES").ToString() = "CNTRY" Then
                    ddlPivotType.SelectedValue = "CNTRY"
                    PivotrowRegions.Visible = True
                    Pivotpackgroup.Visible = False
                    PivotprodGroup.Visible = False
                    Pivotregionset.Visible = True
                    ddlPivotRegionSet.SelectedValue = dsReport.Tables(0).Rows(0).Item("REGIONSETID").ToString()
                    BindRegions()
                    ddlPivotRegion.SelectedValue = dsReport.Tables(0).Rows(0).Item("REGIONID").ToString()
                    ddlPivotRegion.Enabled = True
                    SetPivotCntryReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)

                Else
                    ddlPivotType.SelectedValue = "REGION"
                    Pivotpackgroup.Visible = False
                    PivotrowRegions.Visible = False
                    PivotprodGroup.Visible = False
                    Pivotregionset.Visible = True
                    ddlPivotRegionSet.SelectedValue = dsReport.Tables(0).Rows(0)("REGIONSETID").ToString()
                    SetPivotRegReportFrameWorkTemp(dsRows.Tables(0).Rows.Count, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                End If
            ElseIf dsReport.Tables(0).Rows(0)("RPTTYPE").ToString() = "MIXED" Then

                txtRw.Attributes.Add("onChange", "rowChange();")
                txtCol.Attributes.Add("onChange", "colChange();")
                txtFilter.Attributes.Add("onChange", "filterChange();")

                txtRptName.Text = dsReport.Tables(0).Rows(0)("REPORTNAME").ToString()
                txtCol.Text = dsCol.Tables(0).Rows.Count.ToString()
                txtRw.Text = dsRows.Tables(0).Rows.Count.ToString()
                txtFilter.Text = dsFilter.Tables(0).Rows.Count.ToString()
                btnSubmitt.Enabled = False
                'txtCol.Enabled = False
                'txtRw.Enabled = False
                'txtFilter.Enabled = False
                divCreate.Visible = True
                btnSubmitt.Visible = True
                btnSubmitt.Enabled = True

                SetReportFrameWorkTemp(txtRw.Text.ToString(), txtCol.Text.ToString(), txtFilter.Text, RptID)

            End If
            ViewState("Edit") = "Y"

        Catch ex As Exception
            lblError.Text = "Error:GetReportDetails:" + ex.Message.ToString()
        End Try
    End Sub
    Protected Sub SetReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            dvCol = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()

                        Link.CssClass = "LinkM"

                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            ' If Flag Then
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink



                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        'If Flag Then
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                        'End If
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            dv = dsRows.Tables(0).DefaultView
            For i = 1 To RowCnt
                Tr = New TableRow
                For j = 0 To ColCnt

                    If j = 0 Then
                        Td = New TableCell()
                        Link = New HyperLink

                        Link.Text = "Row_" + i.ToString()

                        Link.ID = "Row_" + i.ToString()
                        Link.CssClass = "LinkM"
                        hyd = New HiddenField
                        hyd.ID = "Row_ID_" + i.ToString()


                        dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTROWID").ToString()
                            If dt.Rows(0).Item("ROWDECRIPTION").ToString() <> "Mixed Row" Then
                                If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                    Link.Text = dt.Rows(0).Item("ROWVALUE").ToString() + " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                                End If
                            Else
                                If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                    Link.Text = dt.Rows(0).Item("ROWVAL1").ToString() + " (" + dt.Rows(0).Item("UNITSHRT1").ToString() + ")/" + dt.Rows(0).Item("ROWVAL2").ToString() + " (" + dt.Rows(0).Item("UNITSHRT2").ToString() + ")"
                                End If
                            End If
                        Else
                            hyd.Value = 0
                        End If

                        GetRowLink(i, Link, RptID, hyd.ID, hyd.Value)

                        Td.Controls.Add(Link)
                        Td.Controls.Add(hyd)
                        Td.Style.Add("text-align", "Left")
                        Td.Style.Add("padding-left", "5px")
                        HeaderTdWLinkSetting(Td, "150px", "", "1")
                    Else
                        Td = New TableCell()
                        Td.Text = "&nbsp;"
                        HeaderTdSetting(Td, "150px", "", "1")
                        Td.CssClass = "AlterNateColor2"
                    End If
                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Tr.Controls.Add(Td)
                Next
                Tr.Height = 30
                tblCAGR.Controls.Add(Tr)
            Next

        Catch ex As Exception
            lblError.Text = "Error:SetReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnCreate_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCreate.Click
        Try
            Session("RPTTYPE") = "MIXED"
            hidRowC.Value = "N"
            hidColumnC.Value = "N"
            hidFilterC.Value = "N"

            txtRw.Attributes.Add("onChange", "rowChange();")
            txtCol.Attributes.Add("onChange", "colChange();")
            txtFilter.Attributes.Add("onChange", "filterChange();")

            divCreate.Visible = True
            txtCol.Text = 1
            txtRw.Text = 1
            txtFilter.Text = 1
            txtRptName.Text = "Test Report"
            btnSubmitt.Visible = True
            btnSubmitt.Enabled = True
            txtCol.Enabled = True
            txtRw.Enabled = True
            txtFilter.Enabled = True
            EnableDisable("CRM")
            ' Dim ReportId As String = String.Empty
            Dim objUpIns As New UpdateInsert()
            hidReportType.Value = "MIXED"
            If Not objRefresh.IsRefresh Then
                hidPropRpt.Value = objUpIns.AddReportDetailsTemp(txtRptName.Text, Session("UserId").ToString(), "MIXED", "", txtFilter.Text.ToString(), txtRw.Text.ToString(), txtCol.Text.ToString(), "0", "Null", "Null", Session("M1ServiceID"))
                SetReportFrameWorkTemp(txtRw.Text.ToString(), txtCol.Text.ToString(), txtFilter.Text, hidPropRpt.Value)
            End If
            ViewState("Edit") = "Y"

        Catch ex As Exception
            lblError.Text = "Error:btnCreate_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnDelete_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnDelete.Click
        Dim ReportId As String = String.Empty
        Dim objUpIns As New UpdateInsert()
        Try
            If Not objRefresh.IsRefresh Then
                If hidPropRpt.Value = "0" Then
                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Please select Proprietary Report');", True)
                Else
                    ReportId = hidPropRpt.Value 'ddlPCases.SelectedValue.ToString()

		     'Log started
                    Dim dsRp As New DataSet
                    Dim objUpInsdata As New M1SubUpInsData.UpdateInsert()
                    Dim objGetData As New Selectdata()
                    dsRp = objGetData.GetReportDetails(hidPropRpt.Value)
                    If dsRp.Tables(0).Rows.Count > 0 Then
                        objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", hidPropRpt.Value, dsRp.Tables(0).Rows(0).Item("RPTTYPE").ToString(), dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "4", hidPropRpt.Value, Session.SessionID)
                    End If
                    'Log Ended

                    objUpIns.DeleteReport(ReportId)
                    GetPCases()
                    GetPReportsDetails()

                   
                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinDelete", "alert('Report#" + ReportId.ToString() + " deleted successfully');", True)
                End If
            End If
            lnkReports.Text = "Display Proprietary Report List"
            hidPropRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnDelete_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnCopy_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCopy.Click
        Dim ReportId As String = String.Empty
        Dim NewReportId As String = String.Empty
        Dim objUpIns As New UpdateInsert()
        Try
            ReportId = hidPropRpt.Value 'ddlPCases.SelectedValue.ToString()
            If Not objRefresh.IsRefresh Then
                If hidPropRpt.Value = "0" Then
                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Please select Proprietary Report');", True)
                Else
                    NewReportId = objUpIns.CreatACopyReport(ReportId, "Prop", Session("UserId").ToString(), Session("M1ServiceID"))
                    objUpIns.PrefrencesInsert(NewReportId)
                    GetPCases()

                    Dim dsRp As New DataSet
                    Dim objUpInsdata As New M1SubUpInsData.UpdateInsert()
                    Dim objGetData As New Selectdata()
                    dsRp = objGetData.GetReportDetails(hidPropRpt.Value)
                    If dsRp.Tables(0).Rows.Count > 0 Then
                        objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", NewReportId, dsRp.Tables(0).Rows(0).Item("RPTTYPE").ToString(), dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "17", hidPropRpt.Value, Session.SessionID)
                    End If


                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinCreate", "alert('Report#" + NewReportId.ToString() + " created successfully.\nReport#" + ReportId.ToString() + " variables transferred to Report#" + NewReportId.ToString() + " successfully.');", True)
                End If
            End If
            lnkReports.Text = "Display Proprietary Report List"
            hidPropRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnCopy_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnCancle_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCancle.Click
        Dim objUpdateData As New M1SubUpInsData.UpdateInsert()
        Try
            If hidPropRpt.Value <> "0" Then
                objUpdateData.DeleteUserReportsTemp(hidPropRpt.Value)
            End If

            divCreate.Visible = False
            EnableDisable("")
            lnkReports.Text = "Display Proprietary Report List"
            hidPropRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnCancle_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub EnableDisable(ByVal Flag As String)
        Try

            Select Case Flag
                Case "CC"
                Case "ED"
                    btnCopy.Enabled = False
                    btnCreate.Enabled = False
                    btnCreateSpecialReport.Enabled = False
                    btnDelete.Enabled = False
                    btnEdit.Enabled = True
                    btnPivotReport.Enabled = False
                Case "DE"
                Case "CR"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = True
                Case "CRU"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = False
                    btnCreateSpecialReport.Enabled = True
                    btnPivotReport.Enabled = False
                Case "CRU1"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = False
                    btnCreateSpecialReport.Enabled = False
                    btnPivotReport.Enabled = True
                Case "CRM"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = False
                    btnPivotReport.Enabled = False
                Case Else
                    btnCopy.Enabled = True
                    btnEdit.Enabled = True
                    btnDelete.Enabled = True
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = True
                    btnPivotReport.Enabled = True
            End Select


        Catch ex As Exception
            lblError.Text = "Error:EnableDisable:" + ex.Message.ToString()
        End Try
    End Sub


    Protected Sub EnableDisableOLD1(ByVal Flag As String)
        Try

            Select Case Flag
                Case "CC"
                Case "ED"
                    btnCopy.Enabled = False
                    btnCreate.Enabled = False
                    btnCreateSpecialReport.Enabled = False
                    btnDelete.Enabled = False
                    btnEdit.Enabled = True
                Case "DE"
                Case "CR"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = True
                Case "CRU"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = False
                    btnCreateSpecialReport.Enabled = True
                Case "CRM"
                    btnCopy.Enabled = False
                    btnEdit.Enabled = False
                    btnDelete.Enabled = False
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = False
                Case Else
                    btnCopy.Enabled = True
                    btnEdit.Enabled = True
                    btnDelete.Enabled = True
                    btnCreate.Enabled = True
                    btnCreateSpecialReport.Enabled = True
            End Select


        Catch ex As Exception
            lblError.Text = "Error:EnableDisable:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnAddNew_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnAddNew.Click
        Try
            divCreate.Visible = False
            divCreateSpecial.Visible = False
            EnableDisable("")
            GetPCases()
            btnAddNew.Visible = False
            lnkReports.Text = "Display Proprietary Report List"
            hidPropRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnCopy_Click:" + ex.Message.ToString()
        End Try
    End Sub


    Protected Sub btnCreateSpecialReport_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCreateSpecialReport.Click
        Try
            Session("RPTTYPE") = "UNIFORM"
            hidRowC.Value = "N"
            hidColumnC.Value = "N"
            hidFilterC.Value = "N"

            ddlSpecialType.Attributes.Add("onChange", "rowChange();")
            txtSpecialCols.Attributes.Add("onChange", "colChange();")
            txtSpecialFilters.Attributes.Add("onChange", "filterChange();")

            divCreateSpecial.Visible = True
            txtSpecialCols.Text = 1
            txtSpecialFilters.Text = 1
            txtSpecialReportName.Text = "Test Report"
            btnSpecialSubmit.Visible = True
            btnSpecialSubmit.Enabled = True
            txtSpecialCols.Enabled = True
            txtSpecialFilters.Enabled = True

            EnableDisable("CRU")
            ddlSpecialType.Enabled = True
            ddlRegionSet.Enabled = True
            ddlUnits.Enabled = True
            BindRegionSet()
            BindUnits()
            lnkRigiondetails.NavigateUrl = "javascript:ShowPopWindow1('../RegionSetsDetails.aspx?RegionSetId=" + ddlRegionSet.SelectedValue + "')"

            'CREATE REPORT WITH DEFAULT FORMAT
            CreateUniformReportTemp()
            ViewState("Edit") = "Y"
            Dim objUpIns As New UpdateInsert()
        Catch ex As Exception

        End Try
    End Sub
    Protected Sub CreateUniformReportTemp()
        Dim objUpIns As New UpdateInsert()
        Dim objGetData As New Selectdata()
        Dim RowCnt As String = String.Empty
        Dim dsRegions As New DataSet
        Dim dsProdGroup As New DataSet
        Dim dsPackTypeGroup As New DataSet
        Dim dsMaterialGroup As New DataSet
        Dim dsPackType As New DataSet
        Dim dsProducts As New DataSet
        Dim dsMaterials As New DataSet
        Dim dsFilters As New DataSet
        Dim dsRowSelector As New DataSet
        Dim dsRows As New DataSet
        Dim listFilterType As New ArrayList
        Dim listFilterValue As New ArrayList
        Dim listFilterType1 As New ArrayList
        Dim listFilterValue1 As New ArrayList
        Dim RowVal1 As String = String.Empty
        Dim RowVal2 As String = String.Empty
        Dim packId As String = String.Empty
        Dim matId As String = String.Empty
        Dim i As Integer
        Dim RegionId As String = String.Empty
        Dim dsFact As New DataSet
        Dim arrFact() As String
        Dim FactId As String = String.Empty
        Try

            If ddlSpecialType.SelectedValue = "REGION" Then
                RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRegions = objGetData.GetReportRegionsByRegionSet(ddlRegionSet.SelectedValue)
                dsRowSelector = objGetData.GetRowsSelectorByCode("REGION")
                RegionId = "null"

            ElseIf ddlSpecialType.SelectedValue = "CNTRY" Then
                If ddlRegions.SelectedValue.ToString() = "0" Then
                    'RowCnt = objGetData.GetReportCountryCount(ddlRegions.SelectedValue.ToString())
                    dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), "-1")
                    RowCnt = dsRegions.Tables(0).Rows.Count
                Else
                    dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), ddlRegions.SelectedValue.ToString())
                    RowCnt = dsRegions.Tables(0).Rows.Count
                End If
                RegionId = ddlRegions.SelectedValue.ToString()
                dsRowSelector = objGetData.GetRowsSelectorByCode("CNTRY")

            ElseIf ddlSpecialType.SelectedValue = "PACKGRP" Then
                RowCnt = objGetData.GetReportPackCount(ddlPackageGrp.SelectedValue.ToString())
                dsPackTypeGroup = objGetData.GetReportPackagesByGroup(ddlPackageGrp.SelectedValue.ToString())
                dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                RegionId = "null"

            ElseIf ddlSpecialType.SelectedValue = "GROUP" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                        For j = 0 To arrFact.Length - 1
                            dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                            If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                If j = 0 Then
                                    FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                Else
                                    FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                End If

                            End If
                        Next
                        FactId = FactId.Remove(FactId.Length - 1)

                        dsFact = objGetData.GetSubFactGroupDetails(FactId)
                        FactId = String.Empty
                        For k = 0 To dsFact.Tables(0).Rows.Count - 1
                            If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                If k = 0 Then
                                    FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                Else
                                    FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                End If
                            End If
                        Next
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsProdGroup = objGetData.GetReportGroupByProdCntry(listFilterType, listFilterValue, ddlProdGrp.SelectedValue.ToString(), FactId)
                        End If
                    End If
                Next
                If dsProdGroup.Tables.Count <> 0 Then
                    If dsProdGroup.Tables(0).Rows.Count <> 0 Then
                        RowCnt = dsProdGroup.Tables(0).Rows.Count
                        dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        hidRowC.Value = "Y"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                        dsProdGroup = objGetData.GetReportDummy("GROUP")
                    End If
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                    dsProdGroup = objGetData.GetReportDummy("GROUP")
                End If
                RegionId = "null"

            ElseIf ddlSpecialType.SelectedValue = "PROD" Then
                'dsRegions = objGetData.GetReportRegionsByRegionSet(Session("M1SubRegionId"))
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsProducts = objGetData.GetReportProductByPackMat(listFilterType, listFilterValue, Session("M1SubGroupId"))
                        End If
                    End If
                Next
                RegionId = "null"
                If dsProducts.Tables.Count <> 0 Then
                    RowCnt = dsProducts.Tables(0).Rows.Count
                    If RowCnt > 0 Then
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                        dsProducts = objGetData.GetReportDummy("PROD")
                    End If

                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                    dsProducts = objGetData.GetReportDummy("PROD")
                End If

            ElseIf ddlSpecialType.SelectedValue = "MAT" Then
                'dsRegions = objGetData.GetReportRegionsByRegionSet(Session("M1SubRegionId"))
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        If dsFilters.Tables(0).Rows(i).Item("FILTERVALUE").ToString() = "All Products" Then
                            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                            For j = 0 To arrFact.Length - 1
                                dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                                If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                    If j = 0 Then
                                        FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    Else
                                        FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    End If

                                End If
                            Next
                            FactId = FactId.Remove(FactId.Length - 1)

                            dsFact = objGetData.GetSubFactGroupDetails(FactId)
                            FactId = String.Empty
                            For k = 0 To dsFact.Tables(0).Rows.Count - 1
                                If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                    If k = 0 Then
                                        FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    Else
                                        FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    End If
                                End If
                            Next

                        End If
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsMaterials = objGetData.GetReportMaterialByProdPack(listFilterType, listFilterValue, FactId)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsMaterials.Tables.Count <> 0 Then
                    If dsMaterials.Tables(0).Rows.Count <> 0 Then
                        RowCnt = dsMaterials.Tables(0).Rows.Count
                        If RowCnt > 0 Then
                            dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                            hidRowC.Value = "Y"
                        Else
                            RowCnt = "1"
                            dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                            dsMaterials = objGetData.GetReportDummy("MAT")
                            If hidFilterC.Value <> "Y" Then
                                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                            End If

                            hidRowC.Value = "Y"
                        End If

                    Else
                        RowCnt = "1"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                        dsMaterials = objGetData.GetReportDummy("MAT")
                        If hidFilterC.Value <> "Y" Then
                            ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                        End If
                        hidRowC.Value = "Y"
                    End If
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                    dsMaterials = objGetData.GetReportDummy("MAT")
                End If

            ElseIf ddlSpecialType.SelectedValue = "PACK" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        If dsFilters.Tables(0).Rows(i).Item("FILTERVALUE").ToString() = "All Products" Then
                            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                            For j = 0 To arrFact.Length - 1
                                dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                                If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                    If j = 0 Then
                                        FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    Else
                                        FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    End If

                                End If
                            Next
                            FactId = FactId.Remove(FactId.Length - 1)

                            dsFact = objGetData.GetSubFactGroupDetails(FactId)
                            FactId = String.Empty
                            For k = 0 To dsFact.Tables(0).Rows.Count - 1
                                If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                    If k = 0 Then
                                        FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    Else
                                        FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    End If
                                End If
                            Next

                        End If
                        listFilterType1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsPackType = objGetData.GetReportPackageByProdMat(listFilterType1, listFilterValue1, FactId)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsPackType.Tables.Count <> 0 Then
                    RowCnt = dsPackType.Tables(0).Rows.Count
                    If RowCnt > 0 Then
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        hidRowC.Value = "Y"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                        dsPackType = objGetData.GetReportDummy("PACK")
                    End If
                Else
                    hidRowC.Value = "Y"
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                    dsPackType = objGetData.GetReportDummy("PACK")
                End If
            ElseIf ddlSpecialType.SelectedValue = "MATGRP" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        listFilterType1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsMaterialGroup = objGetData.GetReportMaterialGroupByProdPack(listFilterType1, listFilterValue1)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsMaterialGroup.Tables.Count <> 0 Then
                    RowCnt = dsMaterialGroup.Tables(0).Rows.Count
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MATGRP")
                    hidRowC.Value = "Y"
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MATGRP")
                    dsMaterialGroup = objGetData.GetReportDummy("MATGRP")
                End If
            End If

            hidReportType.Value = "UNIFORM"

            If Not objRefresh.IsRefresh Then
                If hidPropRpt.Value <> "0" Then
                    hidPropRpt.Value = objUpIns.EditUSERReportDetTemp(hidPropRpt.Value, txtSpecialReportName.Text, txtSpecialFilters.Text.ToString(), RowCnt, txtSpecialCols.Text.ToString(), "UNIFORM", ddlSpecialType.SelectedValue, Session("UserID").ToString(), "", ddlRegionSet.SelectedValue, RegionId, hidRowC.Value, hidColumnC.Value, hidFilterC.Value)
                    If ddlSpecialType.SelectedValue = "CNTRY" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                    ElseIf ddlSpecialType.SelectedValue = "REGION" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                    ElseIf ddlSpecialType.SelectedValue = "PACKGRP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlPackageGrp.SelectedValue, RegionId)
                    ElseIf ddlSpecialType.SelectedValue = "PACK" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlSpecialType.SelectedValue = "PROD" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlSpecialType.SelectedValue = "MATGRP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlSpecialType.SelectedValue = "MAT" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlSpecialType.SelectedValue = "GROUP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlSpecialType.SelectedValue, ddlProdGrp.SelectedValue, RegionId)
                    End If
                Else
                    hidPropRpt.Value = objUpIns.AddReportDetailsTemp(txtSpecialReportName.Text.Trim(), Session("UserId").ToString(), "UNIFORM", "", txtSpecialFilters.Text.Trim(), RowCnt, txtSpecialCols.Text.Trim(), ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId, Session("M1ServiceID"))
                End If

                dsRows = objGetData.GetUsersReportRowsTemp(hidPropRpt.Value)
                For i = 0 To RowCnt - 1

                    If ddlSpecialType.SelectedValue = "PACKGRP" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsPackTypeGroup.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsPackTypeGroup.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlSpecialType.SelectedValue = "PROD" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsProducts.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsProducts.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlSpecialType.SelectedValue = "PACK" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsPackType.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsPackType.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlSpecialType.SelectedValue = "MAT" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsMaterials.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsMaterials.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlSpecialType.SelectedValue = "MATGRP" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsMaterialGroup.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsMaterialGroup.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlSpecialType.SelectedValue = "GROUP" Then
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsProdGroup.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsProdGroup.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    Else
                        objUpIns.UpdateRowDetailsTemp(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsRegions.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsRegions.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    End If
                Next
            End If

            SetSpecialReportFrameWorkTemp(RowCnt, txtSpecialCols.Text.Trim(), txtSpecialFilters.Text, hidPropRpt.Value)

            hidRowC.Value = "N"
            hidColumnC.Value = "N"
            hidFilterC.Value = "N"
        Catch ex As Exception

        End Try
    End Sub
    Protected Sub SetSpecialReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            dvCol = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            ' If Flag Then
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                            'End If
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                lbl.Text = " (" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If

                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next


            For i = 1 To dsRows.Tables(0).Rows.Count
                Tr = New TableRow
                For j = 0 To ColCnt
                    If j = 0 Then
                        Td = New TableCell()
                        lbl = New Label
                        dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                lbl.Text = dt.Rows(0).Item("ROWVALUE").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                            End If
                        End If
                        lbl.CssClass = "Label"
                        Td.Controls.Add(lbl)
                        Td.Style.Add("text-align", "Left")
                        Td.Style.Add("padding-left", "5px")
                        HeaderTdWLinkSetting(Td, "150px", "", "1")
                    Else
                        Td = New TableCell()
                        Td.Text = "&nbsp;"
                        HeaderTdSetting(Td, "150px", "", "1")
                        Td.CssClass = "AlterNateColor2"
                    End If
                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Tr.Controls.Add(Td)
                Next
                Tr.Height = 30
                tblCAGR.Controls.Add(Tr)
            Next

            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "GRAND TOTAL"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then

                            Td.Style.Add("text-align", "Right")
                            Td.Style.Add("padding-right", "5px")
                            Td.CssClass = "AlterNateColor2"
                        End If

                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

        Catch ex As Exception
            lblError.Text = "Error:SetSpecialReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub
    Private Sub BindRegionSet()
        Dim objGetData As New Selectdata()
        Dim DS As New DataSet()
        Dim dsSub As New DataSet()
        Dim RegionId As String = String.Empty
        Try
            DS = objGetData.GetUserRegionSets(Session("M1SubGroupId"))

            With ddlRegionSet
                .DataSource = DS
                .DataTextField = "REGIONSETNAME"
                .DataValueField = "REGIONSETID"
                .DataBind()
            End With

            With ddlPivotRegionSet
                .DataSource = DS
                .DataTextField = "REGIONSETNAME"
                .DataValueField = "REGIONSETID"
                .DataBind()
            End With
        Catch ex As Exception

        End Try
    End Sub
    Private Sub BindUnits()
        Try
            Dim objGetData As New Selectdata()
            Dim DS As New DataSet()
            DS = objGetData.GetUnits("-1", Session("M1SubGroupId"))
            With ddlUnits
                .DataSource = DS
                .DataTextField = "UNITDES"
                .DataValueField = "UNITID"
                .DataBind()
            End With

            With ddlPivotUnit
                .DataSource = DS
                .DataTextField = "UNITDES"
                .DataValueField = "UNITID"
                .DataBind()
            End With
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub ddlSpecialType_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlSpecialType.SelectedIndexChanged
        Try
            If ddlSpecialType.SelectedValue = "REGION" Then
                BindRegionSet()
                rowRegions.Visible = False
                packgroup.Visible = False
                prodGroup.Visible = False
                regionset.Visible = True
            ElseIf ddlSpecialType.SelectedValue = "CNTRY" Then
                rowRegions.Visible = True
                packgroup.Visible = False
                prodGroup.Visible = False
                regionset.Visible = True
                BindRegions()
            ElseIf ddlSpecialType.SelectedValue = "PACKGRP" Then
                regionset.Visible = False
                packgroup.Visible = True
                prodGroup.Visible = False
                rowRegions.Visible = False
                BindPackGroups()
            ElseIf ddlSpecialType.SelectedValue = "PROD" Then
                packgroup.Visible = False
                regionset.Visible = False
                rowRegions.Visible = False
                prodGroup.Visible = False
            ElseIf ddlSpecialType.SelectedValue = "PACK" Then
                packgroup.Visible = False
                regionset.Visible = False
                rowRegions.Visible = False
                prodGroup.Visible = False
            ElseIf ddlSpecialType.SelectedValue = "MATGRP" Then
                regionset.Visible = False
                packgroup.Visible = False
            ElseIf ddlSpecialType.SelectedValue = "MAT" Then
                regionset.Visible = False
                packgroup.Visible = False
                rowRegions.Visible = False
                prodGroup.Visible = False
            ElseIf ddlSpecialType.SelectedValue = "GROUP" Then
                rowRegions.Visible = False
                regionset.Visible = False
                packgroup.Visible = False
                BindProdGroups()
                prodGroup.Visible = True
            End If
        Catch ex As Exception

        End Try
    End Sub

    'Protected Sub btnSpecialSubmit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSpecialSubmit.Click

    '    'Dim FilterType As String = String.Empty
    '    'Dim FilterValue As String = String.Empty
    '    Dim objUpIns As New UpdateInsert()
    '    Dim objGetData As New Selectdata()
    '    Dim ReportId As String = String.Empty
    '    Dim RowCnt As String = String.Empty
    '    Dim ReportFact As String = String.Empty
    '    Dim dsRegions As New DataSet
    '    Dim RowDes As String = String.Empty
    '    Dim dsRowSelector As New DataSet
    '    Dim dsRows As New DataSet
    '    Dim RowVal1 As String = String.Empty
    '    Dim RowVal2 As String = String.Empty
    '    Dim i As Integer
    '    Dim RegionId As String = String.Empty
    '    Try
    '        'ColCnt = txtCol.Text.Trim()
    '        'RowCnt = txtRw.Text.Trim()
    '        ' filterCnt = txtFilter.Text.Trim()
    '        ' ReportName = txtRptName.Text.Trim()

    '        If ddlSpecialType.SelectedValue = "REGION" Then
    '            RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue.ToString())
    '            dsRegions = objGetData.GetReportRegionsByRegionSet(ddlRegionSet.SelectedValue.ToString())
    '            dsRowSelector = objGetData.GetRowsSelectorByCode("REGION")
    '            RegionId = "null"
    '        ElseIf ddlSpecialType.SelectedValue = "CNTRY" Then

    '            If ddlRegions.SelectedValue.ToString() = "0" Then
    '                'RowCnt = objGetData.GetReportCountryCount(ddlRegions.SelectedValue.ToString())
    '                dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), "-1")
    '                RowCnt = dsRegions.Tables(0).Rows.Count
    '            Else
    '                dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), ddlRegions.SelectedValue.ToString())
    '                RowCnt = dsRegions.Tables(0).Rows.Count
    '            End If
    '            RegionId = ddlRegions.SelectedValue.ToString()
    '            dsRowSelector = objGetData.GetRowsSelectorByCode("CNTRY")
    '        End If
    '        hidReportType.Value = "UNIFORM"

    '        ReportId = 0
    '        If Not objRefresh.IsRefresh Then
    '            ReportId = objUpIns.AddReportDetails(txtSpecialReportName.Text.Trim(), Session("UserId").ToString(), "UNIFORM", ReportFact, txtSpecialFilters.Text.Trim(), RowCnt, txtSpecialCols.Text.Trim(), ddlSpecialType.SelectedValue, ddlRegionSet.SelectedValue, RegionId)
    '            dsRows = objGetData.GetUsersReportRows(ReportId)                
    '            For i = 0 To RowCnt - 1
    '                objUpIns.UpdateRowDetails(dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), dsRegions.Tables(0).Rows(i)("NAME").ToString().Replace("'", "''"), dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, dsRowSelector.Tables(0).Rows(0)("ROWDES").ToString(), "0", RowVal1, RowVal2, dsRowSelector.Tables(0).Rows(0)("ROWTYPEID").ToString(), dsRegions.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString())
    '            Next
    '        End If

    '        SetSpecialReportFrameWork(RowCnt, txtSpecialCols.Text.Trim(), txtSpecialFilters.Text, ReportId)
    '        btnSpecialSubmit.Enabled = False
    '        btnAddNew.Visible = True
    '    Catch ex As Exception
    '        lblError.Text = "Error:btnSubmitt_Click " + ex.Message.ToString()
    '    End Try
    'End Sub

    Protected Sub btnSpecialSubmit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSpecialSubmit.Click
        Try
            CreateUniformReportTemp()
            btnSpecialSubmit.Enabled = True
        Catch ex As Exception
            lblError.Text = "Error:btnSubmitt_Click " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnSpecialCancel_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSpecialCancel.Click
        Try
            divCreateSpecial.Visible = False
            EnableDisable("")
            btnAddNew.Visible = False
            lnkReports.Text = "Display Proprietary  Report List"
            hidPropRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnCopy_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub ddlRegionSet_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlRegionSet.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
            BindRegions()
        Catch ex As Exception

        End Try
    End Sub
    Private Sub BindRegions()
        Try
            Dim objGetData As New Selectdata()
            Dim DS As New DataSet()

            DS = objGetData.GetUserRegions(ddlRegionSet.SelectedValue.ToString(), Session("M1ServiceId").ToString(), Session("M1SubRegionId").ToString())
            ddlRegions.Items.Clear()
            Dim lst As New ListItem
            lst.Text = "All"
            lst.Value = 0
            ddlRegions.Items.Add(lst)
            ddlRegions.AppendDataBoundItems = True
            With ddlRegions
                .DataSource = DS
                .DataTextField = "REGIONNAME"
                .DataValueField = "REGIONID"
                .DataBind()
            End With

            ddlPivotRegion.Items.Clear()
            ddlPivotRegion.Items.Add(lst)
            If ViewState("Edit") = "Y" Then
                ddlPivotRegion.AppendDataBoundItems = True
            End If
            With ddlPivotRegion
                .DataSource = DS
                .DataTextField = "REGIONNAME"
                .DataValueField = "REGIONID"
                .DataBind()
            End With
        Catch ex As Exception

        End Try
    End Sub

    Private Sub BindProdGroups()
        Try
            Dim objGetData As New Selectdata()
            Dim DS As New DataSet()
            Dim Dts As DataSet
            Dim DsGroup As DataSet
            Dim DsPackGroup As DataSet
            Dim FactId As String = String.Empty
            Dim PackId As String = String.Empty
            Dim GroupId As String = String.Empty
            Dim StrSql As String = String.Empty
            Dim arrFact() As String
            'DS = objGetData.GetPackageGroups()
            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
            For i = 0 To arrFact.Length - 1
                Dts = objGetData.GetSubGroupDetails(arrFact(i))

                If Dts.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                    If i = 0 Then
                        FactId = Dts.Tables(0).Rows(0).Item("CATID").ToString() + ","
                    Else
                        FactId = FactId + Dts.Tables(0).Rows(0).Item("CATID").ToString() + ","
                    End If

                End If
            Next
            FactId = FactId.Remove(FactId.Length - 1)

            DsGroup = objGetData.GetProductGroupTypeByFact(FactId)
            'For i = 0 To DsGroup.Tables(0).Rows.Count - 1
            '    If DsGroup.Tables(0).Rows(i).Item("PRODUCTGROUPID").ToString() <> "" Then
            '        If i = 0 Then
            '            GroupId = DsGroup.Tables(0).Rows(i).Item("PRODUCTGROUPID").ToString()
            '        Else
            '            GroupId = GroupId + "," + DsGroup.Tables(0).Rows(i).Item("PRODUCTGROUPID").ToString()
            '        End If
            '    End If
            'Next
            'DsPackGroup = objGetData.GetProductGroups(GroupId)

            ddlProdGrp.Items.Clear()
            Dim lst As New ListItem
            lst.Text = "Nothing Selected"
            lst.Value = -1
            ddlProdGrp.Items.Add(lst)
            ddlProdGrp.AppendDataBoundItems = True
            With ddlProdGrp
                .DataSource = DsGroup
                .DataTextField = "NAME"
                .DataValueField = "PRODUCTGROUPID"
                .DataBind()
            End With

            ddlPivotProdGrp.Items.Clear()
            ddlPivotProdGrp.Items.Add(lst)
            If ViewState("Edit") = "Y" Then
                ddlPivotProdGrp.AppendDataBoundItems = True
            End If
            With ddlPivotProdGrp
                .DataSource = DsGroup
                .DataTextField = "NAME"
                .DataValueField = "PRODUCTGROUPID"
                .DataBind()
            End With
        Catch ex As Exception

        End Try
    End Sub

    Private Sub BindPackGroups()
        Try
            Dim objGetData As New Selectdata()
            Dim DS As New DataSet()
            Dim Dts As DataSet
            Dim DsGroup As DataSet
            Dim DsPackGroup As DataSet
            Dim FactId As String = String.Empty
            Dim PackId As String = String.Empty
            Dim GroupId As String = String.Empty
            Dim StrSql As String = String.Empty
            Dim arrFact() As String
            'DS = objGetData.GetPackageGroups()
            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
            For i = 0 To arrFact.Length - 1
                Dts = objGetData.GetSubGroupDetails(arrFact(i))

                If Dts.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                    If i = 0 Then
                        FactId = Dts.Tables(0).Rows(0).Item("CATID").ToString() + ","
                    Else
                        FactId = FactId + Dts.Tables(0).Rows(0).Item("CATID").ToString() + ","
                    End If

                End If
            Next
            FactId = FactId.Remove(FactId.Length - 1)

            Dts = objGetData.GetSubFactGroupDetails(FactId)
            For i = 0 To Dts.Tables(0).Rows.Count - 1
                If i = 0 Then
                    StrSql = Dts.Tables(0).Rows(i).Item("ID").ToString()
                Else
                    StrSql = StrSql + "," + Dts.Tables(0).Rows(i).Item("ID").ToString()
                End If
            Next
            DsGroup = objGetData.GetPackageGroupTypeByFact(StrSql)
            For i = 0 To DsGroup.Tables(0).Rows.Count - 1
                If DsGroup.Tables(0).Rows(i).Item("GROUPID").ToString() <> "" Then
                    If i = 0 Then
                        GroupId = DsGroup.Tables(0).Rows(i).Item("GROUPID").ToString()
                    Else
                        GroupId = GroupId + "," + DsGroup.Tables(0).Rows(i).Item("GROUPID").ToString()
                    End If
                End If
            Next
            DsPackGroup = objGetData.GetPackageGroups(GroupId)

            ddlPackageGrp.Items.Clear()
            Dim lst As New ListItem
            lst.Text = "Nothing Selected"
            lst.Value = -1
            ddlPackageGrp.Items.Add(lst)
            ddlPackageGrp.AppendDataBoundItems = True
            With ddlPackageGrp
                .DataSource = DsPackGroup
                .DataTextField = "GROUPNAME"
                .DataValueField = "ID"
                .DataBind()
            End With
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub btnCopyBcase_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnCopyBcase.Click
        Dim ReportId As String = String.Empty
        Dim NewReportId As String = String.Empty
        Dim objUpIns As New UpdateInsert()
        Try
            ReportId = hidBaseRpt.Value
            If Not objRefresh.IsRefresh Then
                If hidBaseRpt.Value = "0" Then
                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Please select Base Report');", True)
                Else
                    NewReportId = objUpIns.CreatACopyReport(ReportId, "Base", Session("UserId").ToString(), Session("M1ServiceID"))
                    objUpIns.PrefrencesInsert(NewReportId)
                    GetPCases()
                    GetPReportsDetails()
                    Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinCreate", "alert('Report#" + NewReportId.ToString() + " created successfully.\nReport#" + ReportId.ToString() + " variables transferred to Report#" + NewReportId.ToString() + " successfully.');", True)
                End If
            End If
            lnkBReports.Text = "Display Base Report List"
            hidBaseRpt.Value = "0"
        Catch ex As Exception
            lblError.Text = "Error:btnCopy_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnSaveUni_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSaveUni.Click
        Try
            Dim objUpInsdata As New M1SubUpInsData.UpdateInsert()
            Dim objGetData As New Selectdata()
            If Not objRefresh.IsRefresh Then
                'If objGetData.IsNameExists(txtSpecialReportName.Text.Trim(), hidPropRpt.Value, Session("UserId").ToString()) = False Then
                objUpInsdata.UpdateUserReportNameTemp(txtSpecialReportName.Text, hidPropRpt.Value)

                objUpInsdata.SaveUserReports(hidPropRpt.Value)
                objUpInsdata.PrefrencesInsert(hidPropRpt.Value)

                objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", hidPropRpt.Value, "Uniform", "", "1", hidPropRpt.Value, Session.SessionID)

                divCreate.Visible = False
                divCreateSpecial.Visible = False
                EnableDisable("")
                GetPCases()
                GetPReportsDetails()
                lnkReports.Text = "Display Proprietary  Report List"
                hidPropRpt.Value = "0"
                Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Uniform Report saved successfully.');", True)

            End If
        Catch ex As Exception
            lblError.Text = "Error:btnSave_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnSaveMixed_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnSaveMixed.Click
        Try
            Dim objUpInsdata As New M1SubUpInsData.UpdateInsert()
            Dim objGetData As New Selectdata()
            If Not objRefresh.IsRefresh Then
                'If objGetData.IsNameExists(txtRptName.Text.Trim(), hidPropRpt.Value, Session("UserId").ToString()) = False Then
                objUpInsdata.UpdateUserReportNameTemp(txtRptName.Text, hidPropRpt.Value)
                objUpInsdata.SaveUserReports(hidPropRpt.Value)
                objUpInsdata.PrefrencesInsert(hidPropRpt.Value)

                Dim dsRp As New DataSet
                dsRp = objGetData.GetReportDetails(hidPropRpt.Value)
                If dsRp.Tables(0).Rows.Count > 0 Then
                    objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", hidPropRpt.Value, "Mixed", dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "1", hidPropRpt.Value, Session.SessionID)

                End If


                divCreate.Visible = False
                divCreateSpecial.Visible = False
                EnableDisable("")
                GetPCases()
                GetPReportsDetails()
                lnkReports.Text = "Display Proprietary  Report List"
                hidPropRpt.Value = "0"
                Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Mixed Report saved successfully.');", True)
            End If
        Catch ex As Exception
            lblError.Text = "Error:btnSaveMixed_Click:" + ex.Message.ToString()
        End Try
    End Sub


    Protected Sub ddlPackageGrp_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPackageGrp.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub
    Protected Sub ddlRegions_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlRegions.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub ddlProdGrp_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlProdGrp.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub

#Region "PIVOT"
    Protected Sub btnPivotReport_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnPivotReport.Click
        Try
            Session("RPTTYPE") = "PIVOT"
            hidRowC.Value = "N"
            hidColumnC.Value = "N"
            hidFilterC.Value = "N"

            ddlPivotType.Attributes.Add("onChange", "rowChange();")
            txtPivotCols.Attributes.Add("onChange", "colChange();")
            'txtPivotFilters.Attributes.Add("onChange", "filterChange();")

            divPivot.Visible = True
            txtPivotCols.Text = 1
            'txtPivotFilters.Text = 1
            txtPivotReportName.Text = "Test Report"
            btnPivotSubmit.Visible = True
            btnPivotSubmit.Enabled = True
            txtPivotCols.Enabled = True
            'txtPivotFilters.Enabled = True

            EnableDisable("CRU1")
            Session("EDType") = "CRU1"
            ddlPivotType.Enabled = True
            ddlPivotRegionSet.Enabled = True
            ddlPivotUnit.Enabled = True
            BindRegionSet()
            BindUnits()
            lnkRigiondetails.NavigateUrl = "javascript:ShowPopWindow1('../RegionSetsDetails.aspx?RegionSetId=" + ddlRegionSet.SelectedValue + "')"

            'CREATE REPORT WITH DEFAULT FORMAT
            CreatePivotReportTemp()
            'ViewState("Edit") = "Y"
            Dim objUpIns As New UpdateInsert()
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub CreatePivotReportTemp()
        Dim objUpIns As New UpdateInsert()
        Dim objGetData As New Selectdata()
        Dim RowCnt As String = String.Empty
        Dim dsRegions As New DataSet
        Dim dsProdGroup As New DataSet
        Dim dsPackTypeGroup As New DataSet
        Dim dsMaterialGroup As New DataSet
        Dim dsPackType As New DataSet
        Dim dsProducts As New DataSet
        Dim dsMaterials As New DataSet
        Dim dsFilters As New DataSet
        Dim dsRowSelector As New DataSet
        Dim dsRows As New DataSet
        Dim listFilterType As New ArrayList
        Dim listFilterValue As New ArrayList
        Dim listFilterType1 As New ArrayList
        Dim listFilterValue1 As New ArrayList
        Dim RowVal1 As String = String.Empty
        Dim RowVal2 As String = String.Empty
        Dim packId As String = String.Empty
        Dim matId As String = String.Empty
        Dim i As Integer
        Dim RegionId As String = String.Empty
        Dim dsFact As New DataSet
        Dim arrFact() As String
        Dim FactId As String = String.Empty
        Try

            If ddlPivotType.SelectedValue = "REGION" Then
                RowCnt = "1" ' objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRegions = objGetData.GetReportRegionsByRegionSet(ddlRegionSet.SelectedValue)
                dsRowSelector = objGetData.GetRowsSelectorByCode("REGION")
                RegionId = "null"

            ElseIf ddlPivotType.SelectedValue = "CNTRY" Then
                If ddlRegions.SelectedValue.ToString() = "0" Then
                    'RowCnt = objGetData.GetReportCountryCount(ddlRegions.SelectedValue.ToString())
                    dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), "-1")
                    RowCnt = "1" ' dsRegions.Tables(0).Rows.Count
                Else
                    dsRegions = objGetData.GetReportCountriesByRegion(ddlRegionSet.SelectedValue.ToString(), ddlRegions.SelectedValue.ToString())
                    RowCnt = "1" 'dsRegions.Tables(0).Rows.Count
                End If
                RegionId = ddlPivotRegion.SelectedValue.ToString()
                dsRowSelector = objGetData.GetRowsSelectorByCode("CNTRY")

            ElseIf ddlPivotType.SelectedValue = "PACKGRP" Then
                RowCnt = "1" 'objGetData.GetReportPackCount(ddlPackageGrp.SelectedValue.ToString())
                dsPackTypeGroup = objGetData.GetReportPackagesByGroup(ddlPackageGrp.SelectedValue.ToString())
                dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                RegionId = "null"

            ElseIf ddlPivotType.SelectedValue = "GROUP" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                        For j = 0 To arrFact.Length - 1
                            dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                            If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                If j = 0 Then
                                    FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                Else
                                    FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                End If

                            End If
                        Next
                        FactId = FactId.Remove(FactId.Length - 1)

                        dsFact = objGetData.GetSubFactGroupDetails(FactId)
                        FactId = String.Empty
                        For k = 0 To dsFact.Tables(0).Rows.Count - 1
                            If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                If k = 0 Then
                                    FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                Else
                                    FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                End If
                            End If
                        Next
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsProdGroup = objGetData.GetReportGroupByProdCntry(listFilterType, listFilterValue, ddlProdGrp.SelectedValue.ToString(), FactId)
                        End If
                    End If
                Next
                If dsProdGroup.Tables.Count <> 0 Then
                    If dsProdGroup.Tables(0).Rows.Count <> 0 Then
                        RowCnt = "1" 'dsProdGroup.Tables(0).Rows.Count
                        dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        hidRowC.Value = "Y"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                        dsProdGroup = objGetData.GetReportDummy("GROUP")
                    End If
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("GRP")
                    dsProdGroup = objGetData.GetReportDummy("GROUP")
                End If
                RegionId = "null"

            ElseIf ddlPivotType.SelectedValue = "PROD" Then
                'dsRegions = objGetData.GetReportRegionsByRegionSet(Session("M1SubRegionId"))
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsProducts = objGetData.GetReportProductByPackMat(listFilterType, listFilterValue, Session("M1SubGroupId"))
                        End If
                    End If
                Next
                RegionId = "null"
                If dsProducts.Tables.Count <> 0 Then
                    RowCnt = "1" 'dsProducts.Tables(0).Rows.Count
                    If RowCnt > 0 Then
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                        dsProducts = objGetData.GetReportDummy("PROD")
                    End If

                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("PROD")
                    dsProducts = objGetData.GetReportDummy("PROD")
                End If

            ElseIf ddlPivotType.SelectedValue = "MAT" Then
                'dsRegions = objGetData.GetReportRegionsByRegionSet(Session("M1SubRegionId"))
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        If dsFilters.Tables(0).Rows(i).Item("FILTERVALUE").ToString() = "All Products" Then
                            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                            For j = 0 To arrFact.Length - 1
                                dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                                If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                    If j = 0 Then
                                        FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    Else
                                        FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    End If

                                End If
                            Next
                            FactId = FactId.Remove(FactId.Length - 1)

                            dsFact = objGetData.GetSubFactGroupDetails(FactId)
                            FactId = String.Empty
                            For k = 0 To dsFact.Tables(0).Rows.Count - 1
                                If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                    If k = 0 Then
                                        FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    Else
                                        FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    End If
                                End If
                            Next

                        End If
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsMaterials = objGetData.GetReportMaterialByProdPack(listFilterType, listFilterValue, FactId)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsMaterials.Tables.Count <> 0 Then
                    If dsMaterials.Tables(0).Rows.Count <> 0 Then
                        RowCnt = "1" 'dsMaterials.Tables(0).Rows.Count
                        If RowCnt > 0 Then
                            dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                            hidRowC.Value = "Y"
                        Else
                            RowCnt = "1"
                            dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                            dsMaterials = objGetData.GetReportDummy("MAT")
                            If hidFilterC.Value <> "Y" Then
                                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                            End If

                            hidRowC.Value = "Y"
                        End If

                    Else
                        RowCnt = "1"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                        dsMaterials = objGetData.GetReportDummy("MAT")
                        If hidFilterC.Value <> "Y" Then
                            ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                        End If
                        hidRowC.Value = "Y"
                    End If
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MAT")
                    dsMaterials = objGetData.GetReportDummy("MAT")
                End If
            ElseIf ddlPivotType.SelectedValue = "COMPONENT" Then
                'dsRegions = objGetData.GetReportRegionsByRegionSet(Session("M1SubRegionId"))
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        If dsFilters.Tables(0).Rows(i).Item("FILTERVALUE").ToString() = "All Products" Then
                            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                            For j = 0 To arrFact.Length - 1
                                dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                                If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                    If j = 0 Then
                                        FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    Else
                                        FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    End If

                                End If
                            Next
                            FactId = FactId.Remove(FactId.Length - 1)

                            dsFact = objGetData.GetSubFactGroupDetails(FactId)
                            FactId = String.Empty
                            For k = 0 To dsFact.Tables(0).Rows.Count - 1
                                If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                    If k = 0 Then
                                        FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    Else
                                        FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    End If
                                End If
                            Next

                        End If
                        listFilterType.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsMaterials = objGetData.GetReportComponentByProdPack(listFilterType, listFilterValue, FactId)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsMaterials.Tables.Count <> 0 Then
                    If dsMaterials.Tables(0).Rows.Count <> 0 Then
                        RowCnt = "1" 'dsMaterials.Tables(0).Rows.Count
                        If RowCnt > 0 Then
                            dsRowSelector = objGetData.GetRowsSelectorByCode("COMPONENT")
                            hidRowC.Value = "Y"
                        Else
                            RowCnt = "1"
                            dsRowSelector = objGetData.GetRowsSelectorByCode("COMPONENT")
                            dsMaterials = objGetData.GetReportDummy("COMPONENT")
                            If hidFilterC.Value <> "Y" Then
                                ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                            End If

                            hidRowC.Value = "Y"
                        End If

                    Else
                        RowCnt = "1"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("COMPONENT")
                        dsMaterials = objGetData.GetReportDummy("COMPONENT")
                        If hidFilterC.Value <> "Y" Then
                            ScriptManager.RegisterStartupScript(Me, Me.GetType(), "alertMessage", "alertMessage();", True)
                        End If
                        hidRowC.Value = "Y"
                    End If
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("COMPONENT")
                    dsMaterials = objGetData.GetReportDummy("COMPONENT")
                End If

            ElseIf ddlPivotType.SelectedValue = "PACK" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        If dsFilters.Tables(0).Rows(i).Item("FILTERVALUE").ToString() = "All Products" Then
                            arrFact = Regex.Split(Session("M1SubGroupId"), ",")
                            For j = 0 To arrFact.Length - 1
                                dsFact = objGetData.GetSubGroupDetails(arrFact(j))

                                If dsFact.Tables(0).Rows(0).Item("CATID").ToString() <> "" Then
                                    If j = 0 Then
                                        FactId = dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    Else
                                        FactId = FactId + dsFact.Tables(0).Rows(0).Item("CATID").ToString() + ","
                                    End If

                                End If
                            Next
                            FactId = FactId.Remove(FactId.Length - 1)

                            dsFact = objGetData.GetSubFactGroupDetails(FactId)
                            FactId = String.Empty
                            For k = 0 To dsFact.Tables(0).Rows.Count - 1
                                If dsFact.Tables(0).Rows(0).Item("ID").ToString() <> "" Then
                                    If k = 0 Then
                                        FactId = dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    Else
                                        FactId = FactId + "," + dsFact.Tables(0).Rows(k).Item("ID").ToString()
                                    End If
                                End If
                            Next
                        End If
                        listFilterType1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsPackType = objGetData.GetReportPackageByProdMat(listFilterType1, listFilterValue1, FactId)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsPackType.Tables.Count <> 0 Then
                    RowCnt = "1" ' dsPackType.Tables(0).Rows.Count
                    If RowCnt > 0 Then
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                        hidRowC.Value = "Y"
                    Else
                        RowCnt = "1"
                        hidRowC.Value = "Y"
                        dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                        dsPackType = objGetData.GetReportDummy("PACK")
                    End If
                Else
                    hidRowC.Value = "Y"
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("PACK")
                    dsPackType = objGetData.GetReportDummy("PACK")
                End If
            ElseIf ddlPivotType.SelectedValue = "MATGRP" Then
                dsFilters = objGetData.GetReportFiltersByReportId(hidPropRpt.Value)
                For i = 0 To dsFilters.Tables(0).Rows.Count - 1
                    If dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString() <> "" Then
                        listFilterType1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERTYPE").ToString())
                        listFilterValue1.Add(dsFilters.Tables(0).Rows(i).Item("FILTERVALUEID").ToString())
                        If i = dsFilters.Tables(0).Rows.Count - 1 Then
                            dsMaterialGroup = objGetData.GetReportMaterialGroupByProdPack(listFilterType1, listFilterValue1)
                        End If
                    End If
                Next
                RegionId = "null"
                If dsMaterialGroup.Tables.Count <> 0 Then
                    RowCnt = "1" ' dsMaterialGroup.Tables(0).Rows.Count
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MATGRP")
                    hidRowC.Value = "Y"
                Else
                    RowCnt = "1"
                    dsRowSelector = objGetData.GetRowsSelectorByCode("MATGRP")
                    dsMaterialGroup = objGetData.GetReportDummy("MATGRP")
                End If
            End If

            hidReportType.Value = "PIVOT"

            If Not objRefresh.IsRefresh Then
                If hidPropRpt.Value <> "0" Then
                    hidPropRpt.Value = objUpIns.EditUSERReportDetTemp(hidPropRpt.Value, txtPivotReportName.Text, ddlPivotFilters.SelectedValue, RowCnt, txtPivotCols.Text.ToString(), "PIVOT", ddlPivotType.SelectedValue, Session("UserID").ToString(), "", ddlPivotRegionSet.SelectedValue, RegionId, hidRowC.Value, hidColumnC.Value, hidFilterC.Value)
                    If ddlPivotType.SelectedValue = "CNTRY" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                    ElseIf ddlPivotType.SelectedValue = "REGION" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                    ElseIf ddlPivotType.SelectedValue = "PACKGRP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPackageGrp.SelectedValue, RegionId)
                    ElseIf ddlPivotType.SelectedValue = "PACK" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlPivotType.SelectedValue = "PROD" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlPivotType.SelectedValue = "MATGRP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlPivotType.SelectedValue = "MAT" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlPivotType.SelectedValue = "COMPONENT" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId)
                        hidRowC.Value = "N"
                    ElseIf ddlPivotType.SelectedValue = "GROUP" Then
                        objUpIns.UpdateTempReports(hidPropRpt.Value, ddlPivotType.SelectedValue, ddlPivotProdGrp.SelectedValue, RegionId)
                    End If
                Else
                    hidPropRpt.Value = objUpIns.AddReportDetailsTemp(txtPivotReportName.Text.Trim(), Session("UserId").ToString(), "PIVOT", "", ddlPivotFilters.SelectedValue, RowCnt, txtPivotCols.Text.Trim(), ddlPivotType.SelectedValue, ddlPivotRegionSet.SelectedValue, RegionId, Session("M1ServiceID"))
                End If

                dsRows = objGetData.GetUsersReportRowsTemp(hidPropRpt.Value)
                For i = 0 To RowCnt - 1
                    If ddlPivotType.SelectedValue = "PACKGRP" Then
                        objUpIns.UpdateRowDetailsTemp("Package Group", "Package Group", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Package Group", "0", RowVal1, RowVal2, "7", dsPackTypeGroup.Tables(0).Rows(i)("ID").ToString(), ddlUnits.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "PROD" Then
                        objUpIns.UpdateRowDetailsTemp("Product", "Product", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Product", "0", RowVal1, RowVal2, "1", "0", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotProdReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "PACK" Then
                        objUpIns.UpdateRowDetailsTemp("Package", "Package", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Package", "0", RowVal1, RowVal2, "7", "0", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotPackReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "MAT" Then
                        objUpIns.UpdateRowDetailsTemp("Material", "Material", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Material", "0", RowVal1, RowVal2, "8", "0", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotMatReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "COMPONENT" Then
                        objUpIns.UpdateRowDetailsTemp("Component", "Component", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Component", "0", RowVal1, RowVal2, "8", "0", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotCompReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "MATGRP" Then
                        objUpIns.UpdateRowDetailsTemp("Material Group", "Material Group", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Material Group", "0", RowVal1, RowVal2, "8", dsMaterialGroup.Tables(0).Rows(i)("ID").ToString(), ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "GROUP" Then
                        objUpIns.UpdateRowDetailsTemp("Group", "Group", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Group", "0", RowVal1, RowVal2, "6", dsProdGroup.Tables(0).Rows(i)("ID").ToString(), ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotGrpReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    ElseIf ddlPivotType.SelectedValue = "CNTRY" Then
                        objUpIns.UpdateRowDetailsTemp("Country", "Country", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Country", "0", RowVal1, RowVal2, "4", "1", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotCntryReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    Else
                        objUpIns.UpdateRowDetailsTemp("Region", "Region", dsRows.Tables(0).Rows(i)("USERREPORTROWID").ToString, "Region", "0", RowVal1, RowVal2, "3", "1", ddlPivotUnit.SelectedValue.ToString(), hidPropRpt.Value)
                        SetPivotRegReportFrameWorkTemp(RowCnt, txtPivotCols.Text.Trim(), ddlPivotFilters.SelectedValue, hidPropRpt.Value)
                    End If
                Next
            End If

            hidRowC.Value = "N"
            hidColumnC.Value = "N"
            hidFilterC.Value = "N"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub SetPivotRegReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next

                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)

            Next
            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim CompId As String = ""
            Dim dsComp As New DataSet
            Dim arrRfilt(filterCnt) As String

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)

                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)

                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)

                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended

                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)

                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)

                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts("", PackId)

                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")

                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, "")

                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId1, MatId)
                            ElseIf CompId <> "" Then
                                dsPack = objGetData.GetPivotCompAllPackages(ProdId1, CompId)
                                'New Add Started
                            ElseIf GrpId <> "" Then
                                dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, "")
                                'New Add Ended
                            Else
                                dsPack = objGetData.GetPackages(ProdId1)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, PackId)

                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, PackId)

                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        ElseIf MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)

                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, PackId)
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" And PackId <> "" Then
                        dsMat = objGetData.GetPivotPackProdMaterials(ProdId, PackId, MatId)

                    ElseIf ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)

                    ElseIf PackId <> "" Then
                        Dim ProdId1 As String = ""
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        Next
                        ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                        dsMat = objGetData.GetPivotPackMaterials(ProdId1, PackId, MatId)

                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, "")

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If PackId <> "" Then
                                dsComp = objGetData.GetPivotPackProdComponents(ProdId1, PackId, "")
                            Else
                                dsComp = objGetData.GetPivotAllComponents(ProdId1)
                            End If
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, CompId)

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)

                        ElseIf PackId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, CompId)

                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)

                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetReportRegionsByRegionSet(dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString())
                dsRptAct = objGetData.GetPivotReportData_REGION(ProdTbl, MatId, YearId, ProdId, PackId, GrpId, CompId, UnitId, dsTables.Tables(0).Rows.Count, dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString(), dsRows)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    lbl.Width = 200
                                    lbl.Style.Add("display", "inline")
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                           
                                        End If
                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                       
                                        lbl.Text = ""
                                    End If
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)

                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                    Else
                                        dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        'Tr.CssClass = "Bhavesh"
                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 8.5
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = False
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                       
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)

                                    End If

                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        'Tr.CssClass = "Bhavesh"
                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()

                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                Td = New TableCell()
                                                Td.ID = "Layer" + (a + 1).ToString() + "_" + (b + 1).ToString() + "_" + (j + 1).ToString()
                                                If j = 0 Then
                                                    lbl = New Label
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                        End If
                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                      
                                                        lbl.Text = ""
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)

                                            If filterCnt = 2 Then
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                                    Else
                                                        dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        'Tr.CssClass = "Bhavesh"
                                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                   
                                                                    lbl.Text = ""
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)

                                                    End If

                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            Else
                                                                strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            Else
                                                                strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "GROUP" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                            Else
                                                                strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "COMPONENT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                            Else
                                                                strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                            End If
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        Tr = New TableRow
                                                        'Tr.CssClass = "Bhavesh"
                                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        If dtRpt.Rows.Count > 0 Then
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Font.Size = 8.5
                                                                    Td.Font.Bold = True
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                        End If
                                                                        lbl.Text = "" 'FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        lbl.Text = ""
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If
                                                        

                                                        For i = 1 To dsRows.Tables(0).Rows.Count
                                                            If strRFilt3 <> "" Then
                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND FCT<>0"
                                                            Else
                                                                dvRptAct.RowFilter = " REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString()
                                                            End If
                                                            dtRptAct = dvRptAct.ToTable()
                                                            If dtRptAct.Rows.Count > 0 Then
                                                                Tr = New TableRow
                                                                'Tr.CssClass = "Bhavesh"
                                                                'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                                'Tr.Style.Add("display", "none")
                                                                For j = 0 To ColCnt
                                                                    If j = 0 Then
                                                                        Td = New TableCell()
                                                                        lbl = New Label
                                                                        lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                                                        lbl.CssClass = "Label"
                                                                        Td.Controls.Add(lbl)
                                                                        Td.Style.Add("text-align", "Left")
                                                                        Td.Style.Add("padding-left", "75px")
                                                                        HeaderTdSetting(Td, "180px", "", "1")
                                                                    Else
                                                                        Td = New TableCell()
                                                                        lbl = New Label
                                                                        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                            Dim ProdCount As New Double
                                                                            If strRFilt3 <> "" Then
                                                                                dvRptAct.RowFilter = strRFilt3 + " AND REGIONID = " + dsRows.Tables(0).Rows(i - 1).Item("ID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                            Else
                                                                                dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                            End If
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                               
                                                                            End If
                                                                            lbl.Text = "" 'FormatNumber(ProdCount.ToString(), 0)
                                                                        Else
                                                                            Dim count1 As New Double
                                                                            Dim count2 As New Double
                                                                            Dim diff As New Double
                                                                           
                                                                            lbl.Text = ""
                                                                        End If
                                                                        lbl.CssClass = "Label"
                                                                        Td.Controls.Add(lbl)
                                                                        Td.CssClass = "AlterNateColor2"
                                                                        Td.Style.Add("text-align", "Right")
                                                                        Td.Style.Add("padding-right", "10px")
                                                                    End If
                                                                    Td.Font.Size = 8.5
                                                                    Td.Font.Name = "Verdana"
                                                                    Td.Font.Bold = False
                                                                    Tr.Controls.Add(Td)
                                                                Next
                                                                Tr.Height = 30
                                                                tblCAGR.Controls.Add(Tr)
                                                            End If

                                                        Next
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                'dv.RowFilter = "ROWSEQUENCE = " + i.ToString()
                                'dt = dv.ToTable()
                                'If (dt.Rows.Count > 0) Then
                                '    If dt.Rows(0).Item("ROWVALUE").ToString() <> "" Then
                                '        lbl.Text = dt.Rows(0).Item("NAME").ToString() '+ " (" + dt.Rows(0).Item("UNITSHRT").ToString() + ")"
                                '    End If
                                'End If
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("NAME").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "180px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString(), "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "180px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotRegReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotCntryReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim RegionId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If
            RegionId = dsRep.Tables(0).Rows(0).Item("REGIONID").ToString()
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim GrpId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsGrp As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended
                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        'ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackMatProducts(ProdId, PackId, MatId)
                        ElseIf CompId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackCompProducts(ProdId, PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" And PackId <> "" Then
                            dsProd = objGetData.GetPivotPackGRPProducts(ProdId, PackId, GrpId)
                            'New Add Ended

                        ElseIf MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                        ElseIf PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If
                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")
                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, "")
                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended
                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId1, MatId)
                            ElseIf CompId <> "" Then
                                dsPack = objGetData.GetPivotCompAllPackages(ProdId1, CompId)
                                'New Add Started
                            ElseIf GrpId <> "" Then
                                dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, "")
                                'New Add Ended
                            Else
                                dsPack = objGetData.GetPackages(ProdId1)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And MatId <> "" Then
                            dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, PackId)
                        ElseIf ProdId <> "" And CompId <> "" Then
                            dsPack = objGetData.GetProdCompPackages(ProdId, CompId, PackId)
                            'New Add Started
                        ElseIf ProdId <> "" And GrpId <> "" Then
                            dsPack = objGetData.GetPivotPRODGRPPackages(ProdId, GrpId, "")
                            'New Add Ended

                        ElseIf ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)
                        ElseIf MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, PackId)
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If
                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" And PackId <> "" Then
                        dsMat = objGetData.GetPivotPackProdMaterials(ProdId, PackId, MatId)
                    ElseIf ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)
                    ElseIf PackId <> "" Then
                        Dim ProdId1 As String = ""
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdId1 = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                        Next
                        ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                        dsMat = objGetData.GetPivotPackMaterials(ProdId1, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, "")

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            If PackId <> "" Then
                                dsComp = objGetData.GetPivotPackProdComponents(ProdId1, PackId, "")
                            Else
                                dsComp = objGetData.GetPivotAllComponents(ProdId1)
                            End If
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" And PackId <> "" Then
                            dsComp = objGetData.GetPivotPackProdComponents(ProdId, PackId, CompId)

                        ElseIf ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)

                        ElseIf PackId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotPackComponents(ProdId1, PackId, CompId)

                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable

            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetPivotCountry(RegionId)
                dsRptAct = objGetData.GetPivotReportData_COUNTRY(ProdTbl, YearId, ProdId, PackId, MatId, GrpId, CompId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            'strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        Else
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'If count1 <> 0 And count2 <> 0 Then
                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        'Else
                                        '    lbl.Text = FormatNumber(0, 4)
                                        'End If
                                        lbl.Text = ""
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            ' Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                    Else
                                        dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        'Tr.CssClass = "Bhavesh"
                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        Else
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" 'FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'If count1 <> 0 And count2 <> 0 Then
                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    'Else
                                                    '    lbl.Text = FormatNumber(0, 4)
                                                    'End If
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "GROUP" And arrRfilt(1) <> "COUNTRY" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            strRFilt2 = strRFilt1
                                            'If strRFilt1 <> "" Then
                                            '    strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            'Else
                                            '    strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            'End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            Tr = New TableRow
                                            'Tr.CssClass = "Bhavesh"
                                            'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                            'Tr.Style.Add("display", "none")
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    'imgUp = New ImageButton
                                                    'imgDn = New ImageButton
                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    'imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    'imgUp.Width = 20
                                                    'imgUp.Height = 12
                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    'imgDn.Width = 20
                                                    'imgDn.Height = 12
                                                    'Td.Controls.Add(imgUp)
                                                    'Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        Else
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                            '            ElseIf UnitId = 3 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        End If
                                                            '    End If
                                                            'Next
                                                        End If
                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                        'If strRFilt2 <> "" Then
                                                        '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'Else
                                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'End If
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        Else
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If

                                                        'If strRFilt2 <> "" Then
                                                        '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'Else
                                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'End If
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        Else
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If

                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        'If count1 <> 0 And count2 <> 0 Then
                                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        'Else
                                                        '    lbl.Text = FormatNumber(0, 4)
                                                        'End If
                                                        lbl.Text = ""
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30

                                            If filterCnt = 2 Then
                                                tblCAGR.Controls.Add(Tr)
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                                    Else
                                                        dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        'Tr.CssClass = "Bhavesh"
                                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        Else
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '            ElseIf UnitId = 3 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    End If
                                                                        'Next
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                                    'If strRFilt2 <> "" Then
                                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'Else
                                                                    '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'End If
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If

                                                                    'If strRFilt2 <> "" Then
                                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'Else
                                                                    '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'End If
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If

                                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    'If count1 <> 0 And count2 <> 0 Then
                                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    'Else
                                                                    '    lbl.Text = FormatNumber(0, 4)
                                                                    'End If
                                                                    lbl.Text = ""
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If

                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "GROUP" And arrRfilt(2) <> "COUNTRY" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    tblCAGR.Controls.Add(Tr)
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        Tr = New TableRow
                                                        Tr = New TableRow
                                                        'Tr.CssClass = "Bhavesh"
                                                        'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        ElseIf arrRfilt(2) = "GROUP" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        ElseIf arrRfilt(2) = "COMPONENT" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        If dtRpt.Rows.Count > 0 Then
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    'imgUp = New ImageButton
                                                                    'imgDn = New ImageButton
                                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                    'imgUp.Style.Add("display", "none")
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                    'imgUp.Width = 20
                                                                    'imgUp.Height = 12
                                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                    'imgDn.Width = 20
                                                                    'imgDn.Height = 12
                                                                    'Td.Controls.Add(imgUp)
                                                                    'Td.Controls.Add(imgDn)
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        If strRFilt3 <> "" Then
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        Else
                                                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        End If
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        Else
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '            ElseIf UnitId = 3 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    End If
                                                                            'Next
                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                                        'If strRFilt3 <> "" Then
                                                                        '    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'Else
                                                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'End If
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        Else
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If

                                                                        'If strRFilt3 <> "" Then
                                                                        '    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'Else
                                                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'End If
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        Else
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If

                                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        'If count1 <> 0 And count2 <> 0 Then
                                                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        'Else
                                                                        '    lbl.Text = FormatNumber(0, 4)
                                                                        'End If
                                                                        lbl.Text = ""
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)

                                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                                If strRFilt3 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND FCT<>0"
                                                                Else
                                                                    dvRptAct.RowFilter = " COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    Tr = New TableRow
                                                                    'Tr.CssClass = "Bhavesh"
                                                                    'Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                                    'Tr.Style.Add("display", "none")
                                                                    For j = 0 To ColCnt
                                                                        If j = 0 Then
                                                                            Td = New TableCell()
                                                                            lbl = New Label
                                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                                                            lbl.CssClass = "Label"
                                                                            Td.Controls.Add(lbl)
                                                                            Td.Font.Size = 8.5
                                                                            Td.Font.Bold = True
                                                                            Td.Style.Add("text-align", "Left")
                                                                            Td.Style.Add("padding-left", "75px")
                                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                                        Else
                                                                            Td = New TableCell()
                                                                            lbl = New Label
                                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                                Dim ProdCount As New Double
                                                                                If strRFilt3 <> "" Then
                                                                                    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                                Else
                                                                                    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                                End If
                                                                                dtRptAct = dvRptAct.ToTable()
                                                                                If dtRptAct.Rows.Count > 0 Then
                                                                                    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                                    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                    '            If UnitId = 1 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            ElseIf UnitId = 2 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            ElseIf UnitId = 4 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            Else
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            End If
                                                                                    '        Else
                                                                                    '            If UnitId = 1 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                    '            ElseIf UnitId = 2 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                    '            ElseIf UnitId = 3 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                    '            ElseIf UnitId = 4 Then
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            Else
                                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                    '            End If
                                                                                    '        End If
                                                                                    '    End If
                                                                                    'Next
                                                                                End If
                                                                                lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                            Else
                                                                                Dim count1 As New Double
                                                                                Dim count2 As New Double
                                                                                Dim diff As New Double
                                                                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                                'dtRptCols1 = dvRptCols1.ToTable()
                                                                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                                'dtRptCols2 = dvRptCols2.ToTable()

                                                                                'If strRFilt3 <> "" Then
                                                                                '    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                'Else
                                                                                '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                'End If
                                                                                'dtRptAct = dvRptAct.ToTable()
                                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                '    '            If UnitId = 1 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            ElseIf UnitId = 2 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            ElseIf UnitId = 4 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            Else
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            End If
                                                                                '    '        Else
                                                                                '    '            If UnitId = 1 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                '    '            ElseIf UnitId = 2 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                '    '            ElseIf UnitId = 3 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                '    '            ElseIf UnitId = 4 Then
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            Else
                                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            End If
                                                                                '    '        End If
                                                                                '    '    End If
                                                                                '    'Next
                                                                                'End If

                                                                                'If strRFilt3 <> "" Then
                                                                                '    dvRptAct.RowFilter = strRFilt3 + " AND COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                'Else
                                                                                '    dvRptAct.RowFilter = "COUNTRYID = " + dsRows.Tables(0).Rows(i - 1).Item("COUNTRYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                                'End If
                                                                                'dtRptAct = dvRptAct.ToTable()
                                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                '    '            If UnitId = 1 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            ElseIf UnitId = 2 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            ElseIf UnitId = 4 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            Else
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            End If
                                                                                '    '        Else
                                                                                '    '            If UnitId = 1 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                '    '            ElseIf UnitId = 2 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                '    '            ElseIf UnitId = 3 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                '    '            ElseIf UnitId = 4 Then
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            Else
                                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '    '            End If
                                                                                '    '        End If
                                                                                '    '    End If
                                                                                '    'Next
                                                                                'End If

                                                                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                                'If count1 <> 0 And count2 <> 0 Then
                                                                                '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                                'Else
                                                                                '    lbl.Text = FormatNumber(0, 4)
                                                                                'End If
                                                                                lbl.Text = ""
                                                                            End If
                                                                            lbl.CssClass = "Label"
                                                                            Td.Controls.Add(lbl)
                                                                            Td.CssClass = "AlterNateColor2"
                                                                            Td.Style.Add("text-align", "Right")
                                                                            Td.Style.Add("padding-right", "10px")
                                                                        End If
                                                                        Td.Font.Size = 8.5
                                                                        Td.Font.Name = "Verdana"
                                                                        Td.Font.Bold = False
                                                                        Tr.Controls.Add(Td)
                                                                    Next
                                                                    Tr.Height = 30
                                                                    tblCAGR.Controls.Add(Tr)
                                                                End If

                                                            Next
                                                        End If
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("COUNTRYDES").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotMatReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If
            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdComponent(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            dsPack = objGetData.GetComponents(ProdId)
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdComponent(ProdId, PackId)
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable
            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                dsRows = objGetData.GetPivotMaterials(ProdId, PackId)
                dsRptAct = objGetData.GetPivotReportData_MAT(ProdTbl, YearId, ProdId, PackId, GrpId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                Dim strRFilt1 As String = ""
                Dim strRFilt2 As String = ""
                Dim strRFilt3 As String = ""
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl = New Label
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    Else
                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" 'FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()
                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    Else
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    Else
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If
                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        lbl.Text = ""
                                    End If
                                    Td.Controls.Add(lbl)
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdWLinkSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                strRFilt = ""
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdWLinkSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    Else
                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount, 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()
                                                    'If strRFilt1 = "" Then
                                                    '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    Else
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt1 = "" Then
                                                    '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    Else
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    'imgUp = New ImageButton
                                                    'imgDn = New ImageButton
                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    'imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    'imgUp.Width = 20
                                                    'imgUp.Height = 12
                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    'imgDn.Width = 20
                                                    'imgDn.Height = 12
                                                    'Td.Controls.Add(imgUp)
                                                    'Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        End If
                                                            '    Else
                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                            '            ElseIf UnitId = 3 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        End If
                                                            '    End If
                                                            'Next
                                                        End If
                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                        'dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    Else
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If

                                                        'dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    Else
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If
                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        lbl.Text = ""
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        End If

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = "MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    Else
                                                                    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '            ElseIf UnitId = 3 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    End If
                                                                    'Next
                                                                End If
                                                                lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                'dtRptCols1 = dvRptCols1.ToTable()
                                                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                'dtRptCols2 = dvRptCols2.ToTable()
                                                                'If strRFilt2 = "" Then
                                                                '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    Else
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If

                                                                'If strRFilt2 = "" Then
                                                                '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    Else
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If
                                                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                lbl.Text = ""
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    Tr = New TableRow()
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = strRFilt + "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRpt.Rows.Count > 0 Then
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'imgUp = New ImageButton
                                                                'imgDn = New ImageButton
                                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                'imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                'imgUp.Width = 20
                                                                'imgUp.Height = 12
                                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                'imgDn.Width = 20
                                                                'imgDn.Height = 12
                                                                'Td.Controls.Add(imgUp)
                                                                'Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Bold = True
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'HeaderTdSetting(Td, "150px", "", "1")
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    Else
                                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '            ElseIf UnitId = 3 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    End If
                                                                        'Next
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    Else
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    Else
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If
                                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    lbl.Text = ""
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            Dim bFlag = False
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    Else
                                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '            ElseIf UnitId = 3 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    End If
                                                                            'Next
                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    Else
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    Else
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If
                                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        lbl.Text = ""
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")

                                                                    'If lbl.Text <> "0" Then
                                                                    '    bFlag = True
                                                                    'End If
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            'tblCAGR.Controls.Add(Tr)
                                                            'If bFlag = True Then
                                                            tblCAGR.Controls.Add(Tr)
                                                            ' End If
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdWLinkSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdWLinkSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotMatReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotCompReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If
            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdWLinkSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)

                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable
            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                dsRows = objGetData.GetPivotComponents(ProdId, PackId)
                dsRptAct = objGetData.GetPivotReportData_COMP(ProdTbl, YearId, ProdId, PackId, GrpId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                Dim strRFilt1 As String = ""
                Dim strRFilt2 As String = ""
                Dim strRFilt3 As String = ""
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl = New Label
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    Else
                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" 'FormatNumber(ProdCount, 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()
                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    Else
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    Else
                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If
                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        lbl.Text = ""
                                    End If
                                    Td.Controls.Add(lbl)
                                    'Td.CssClass = "AlterNateColor2"
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Font.Size = 9
                                    Td.Font.Name = "Verdana"
                                    Td.Font.Bold = True
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdWLinkSetting(Td, "130px", "", "1")
                                End If
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                strRFilt = ""
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdWLinkSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 = "" Then
                                                        dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = strRFilt1 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    Else
                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount, 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()
                                                    'If strRFilt1 = "" Then
                                                    '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    Else
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt1 = "" Then
                                                    '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    Else
                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    'imgUp = New ImageButton
                                                    'imgDn = New ImageButton
                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    'imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    'imgUp.Width = 20
                                                    'imgUp.Height = 12
                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    'imgDn.Width = 20
                                                    'imgDn.Height = 12
                                                    'Td.Controls.Add(imgUp)
                                                    'Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Font.Size = 9
                                                    Td.Font.Bold = True
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        End If
                                                            '    Else
                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                            '            If UnitId = 1 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                            '            ElseIf UnitId = 2 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                            '            ElseIf UnitId = 3 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                            '            ElseIf UnitId = 4 Then
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            Else
                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                            '            End If
                                                            '        End If
                                                            '    End If
                                                            'Next
                                                        End If
                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                        'dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    Else
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If

                                                        'dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                        'dtRptAct = dvRptAct.ToTable()
                                                        'If dtRptAct.Rows.Count > 0 Then
                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    Else
                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '    '            If UnitId = 1 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '    '            ElseIf UnitId = 2 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '    '            ElseIf UnitId = 3 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '    '            ElseIf UnitId = 4 Then
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            Else
                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '    '            End If
                                                        '    '        End If
                                                        '    '    End If
                                                        '    'Next
                                                        'End If
                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                        lbl.Text = ""
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("padding-right", "10px")
                                                    Td.Style.Add("text-align", "Right")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        End If

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 = "" Then
                                                                    dvRptAct.RowFilter = "COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    Else
                                                                    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '            ElseIf UnitId = 3 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    End If
                                                                    'Next
                                                                End If
                                                                lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                'dtRptCols1 = dvRptCols1.ToTable()
                                                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                'dtRptCols2 = dvRptCols2.ToTable()
                                                                'If strRFilt2 = "" Then
                                                                '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    Else
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If

                                                                'If strRFilt2 = "" Then
                                                                '    dvRptAct.RowFilter = " MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    Else
                                                                '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If
                                                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                lbl.Text = ""
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    Tr = New TableRow()
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = strRFilt + "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRpt.Rows.Count > 0 Then
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'imgUp = New ImageButton
                                                                'imgDn = New ImageButton
                                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                'imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                'imgUp.Width = 20
                                                                'imgUp.Height = 12
                                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                'imgDn.Width = 20
                                                                'imgDn.Height = 12
                                                                'Td.Controls.Add(imgUp)
                                                                'Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Bold = True
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'HeaderTdSetting(Td, "150px", "", "1")
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    Else
                                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '            ElseIf UnitId = 3 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    End If
                                                                        'Next
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    Else
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    Else
                                                                    '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If
                                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    lbl.Text = ""
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            Dim bFlag = False
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdWLinkSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND COMPONENTID = " + dsRows.Tables(0).Rows(i - 1).Item("COMPONENTID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    Else
                                                                            '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '            ElseIf UnitId = 3 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    End If
                                                                            'Next
                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    Else
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND MATERIALID = " + dsRows.Tables(0).Rows(i - 1).Item("MATERIALID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    Else
                                                                        '    '        If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If
                                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        'lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        lbl.Text = ""
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")

                                                                    'If lbl.Text <> "0" Then
                                                                    '    bFlag = True
                                                                    'End If
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            'tblCAGR.Controls.Add(Tr)
                                                            'If bFlag = True Then
                                                            tblCAGR.Controls.Add(Tr)
                                                            ' End If
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                'For l = 0 To dtRptAct.Rows.Count - 1
                    '                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                '            If UnitId = 1 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        Else
                    '                '            If UnitId = 1 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                '            ElseIf UnitId = 2 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                '            ElseIf UnitId = 3 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                '            ElseIf UnitId = 4 Then
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            Else
                    '                '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                '            End If
                    '                '        End If
                    '                '    End If
                    '                'Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdWLinkSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label

                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdWLinkSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotCompReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotPackReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        Dim GrpId As String = ""
        Dim dsGrp As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If
            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count
            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If
            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView

            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If

                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If MatId <> "" Then
                            dsProd = objGetData.GetPivotMatProducts(MatId, ProdId)
                        ElseIf CompId <> "" Then
                            dsProd = objGetData.GetPivotCompProducts(CompId, ProdId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsProd = objGetData.GetPivotGRPProducts(ProdId, GrpId)
                            'New Add Ended
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If ProdId <> "" Then
                        dsMat = objGetData.GetPivotProdMaterials(ProdId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, "")

                        Else
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsComp = objGetData.GetPivotAllComponents(ProdId1)
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsComp = objGetData.GetPivotProdComponents(ProdId, CompId)
                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                    RowCnt += 1
                Next
                ProdId = ProdId.Remove(ProdId.Length - 1)
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable
            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                If CompId <> "" Then
                    dsRows = objGetData.GetPivotComponentsPackages(ProdId, CompId)
                Else
                    dsRows = objGetData.GetPivotPackages(ProdId, MatId)
                End If

                dsRptAct = objGetData.GetPivotReportData_PACK(ProdTbl, YearId, ProdId, MatId, GrpId, CompId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        strRFilt1 = ""
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then

                        ElseIf arrRfilt(0) = "REGION" Then

                        End If
                        If strRFilt1 <> "" Then
                            dvRpt.RowFilter = strRFilt1
                        End If
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        Else
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If
                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'If count1 <> 0 And count2 <> 0 Then
                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        'Else
                                        '    lbl.Text = FormatNumber(0, 4)
                                        'End If
                                        lbl.Text = ""
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Font.Bold = True
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    'dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
 				    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                    Else
                                        dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        Else
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" 'FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'If count1 <> 0 And count2 <> 0 Then
                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    'Else
                                                    '    lbl.Text = FormatNumber(0, 4)
                                                    'End If
                                                    lbl.Text = ""
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.CssClass = "AlterNateColor2"
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            strRFilt2 = strRFilt1
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            strRFilt2 = strRFilt1
                                        End If

                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                'imgUp = New ImageButton
                                                'imgDn = New ImageButton
                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                'imgUp.Style.Add("display", "none")
                                                lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                'imgUp.Width = 20
                                                'imgUp.Height = 12
                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                'imgDn.Width = 20
                                                'imgDn.Height = 12
                                                'Td.Controls.Add(imgUp)
                                                'Td.Controls.Add(imgDn)
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        Else
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                    'If strRFilt2 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt2 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'If count1 <> 0 And count2 <> 0 Then
                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    'Else
                                                    '    lbl.Text = FormatNumber(0, 4)
                                                    'End If
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("color", "#660022")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.Style.Add("text-align", "Right")
                                            End If
                                            Td.Font.Size = 9
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = True
                                            Tr.Controls.Add(Td)
                                        Next

                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count

                                                If strRFilt2 <> "" Then
                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                Else
                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                End If
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                If strRFilt2 <> "" Then
                                                                    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                Else
                                                                    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                End If
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        Else
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '            ElseIf UnitId = 3 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    End If
                                                                    'Next
                                                                End If
                                                                lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                'dtRptCols1 = dvRptCols1.ToTable()
                                                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                'dtRptCols2 = dvRptCols2.ToTable()

                                                                'If strRFilt2 <> "" Then
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        Else
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If

                                                                'If strRFilt2 <> "" Then
                                                                '    dvRptAct.RowFilter = strRFilt2 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'Else
                                                                '    dvRptAct.RowFilter = " PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'End If
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        Else
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If
                                                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                'If count1 <> 0 And count2 <> 0 Then
                                                                '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                'Else
                                                                '    lbl.Text = FormatNumber(0, 4)
                                                                'End If
                                                                lbl.Text = ""
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If

                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "MATERIAL" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt3 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COMPONENT" Then
                                                        If strRFilt3 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    'New Change started
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    'New change ended

                                                    If dtRpt.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'imgUp = New ImageButton
                                                                'imgDn = New ImageButton
                                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                'imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                'imgUp.Width = 20
                                                                'imgUp.Height = 12
                                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                'imgDn.Width = 20
                                                                'imgDn.Height = 12
                                                                'Td.Controls.Add(imgUp)
                                                                'Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        Else
                                                                        '            If UnitId = 1 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '            ElseIf UnitId = 2 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '            ElseIf UnitId = 3 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '            ElseIf UnitId = 4 Then
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            Else
                                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '            End If
                                                                        '        End If
                                                                        '    End If
                                                                        'Next
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If
                                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    'If count1 <> 0 And count2 <> 0 Then
                                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    'Else
                                                                    '    lbl.Text = FormatNumber(0, 4)
                                                                    'End If
                                                                    lbl.Text = ""
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                   

                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString()
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        Else
                                                                            '            If UnitId = 1 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '            ElseIf UnitId = 2 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '            ElseIf UnitId = 3 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '            ElseIf UnitId = 4 Then
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            Else
                                                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '            End If
                                                                            '        End If
                                                                            '    End If
                                                                            'Next
                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                        'dtRptCols1 = dvRptCols1.ToTable()
                                                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                        'dtRptCols2 = dvRptCols2.ToTable()

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        Else
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If

                                                                        'dvRptAct.RowFilter = strRFilt3 + " AND PACKAGETYPEID = " + dsRows.Tables(0).Rows(i - 1).Item("PACKAGETYPEID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                        'dtRptAct = dvRptAct.ToTable()
                                                                        'If dtRptAct.Rows.Count > 0 Then
                                                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        Else
                                                                        '    '            If UnitId = 1 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '    '            ElseIf UnitId = 2 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '    '            ElseIf UnitId = 3 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '    '            ElseIf UnitId = 4 Then
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            Else
                                                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '    '            End If
                                                                        '    '        End If
                                                                        '    '    End If
                                                                        '    'Next
                                                                        'End If
                                                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                        'If count1 <> 0 And count2 <> 0 Then
                                                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                        'Else
                                                                        '    lbl.Text = FormatNumber(0, 4)
                                                                        'End If
                                                                        lbl.Text = ""
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If
                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotPackReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotProdReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Dim CompId As String = ""
        Dim dsComp As New DataSet
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""
            Dim GrpId As String = ""
            Dim dsGrp As New DataSet

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                RowCnt += 1
            Next
            ProdId = ProdId.Remove(ProdId.Length - 1)

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        'If ProdId <> "" And MatId <> "" Then
                        'dsPack = objGetData.GetPivotProdMatPackages(ProdId, MatId, "")
                        'ElseIf ProdId <> "" Then
                        'dsPack = objGetData.GetPackages(ProdId)
                        'Else
                        If MatId <> "" Then
                            dsPack = objGetData.GetPivotMatAllPackages(ProdId, MatId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompAllPackages(ProdId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId, GrpId, "")
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPackages(ProdId)
                        End If
                        'End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If MatId <> "" Then
                            dsPack = objGetData.GetPivotMatPackages(MatId, PackId)
                        ElseIf CompId <> "" Then
                            dsPack = objGetData.GetPivotCompPackages(PackId, CompId)
                            'New Add Started
                        ElseIf GrpId <> "" Then
                            Dim ProdId1 As String = ""
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdId1 = ProdId1 + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            Next
                            ProdId1 = ProdId1.Remove(ProdId1.Length - 1)
                            dsPack = objGetData.GetPivotGRPAllPackages(ProdId1, GrpId, PackId)
                            'New Add Ended
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If PackId <> "" Then
                        dsMat = objGetData.GetPivotPackMaterials(ProdId, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COMPONENT" Then
                    arrRfilt(a) = "COMPONENT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If PackId <> "" Then
                            dsComp = objGetData.GetPivotPackComponents(ProdId, PackId, "")
                        Else
                            dsComp = objGetData.GetPivotAllComponents(ProdId)
                        End If
                        For b = 0 To dsComp.Tables(0).Rows.Count - 1
                            CompId = CompId + "" + dsComp.Tables(0).Rows(b).Item("COMPONENTID").ToString() + ","
                        Next
                        CompId = CompId.Remove(CompId.Length - 1)
                    Else
                        CompId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If PackId <> "" Then
                            dsComp = objGetData.GetPivotPackComponents(ProdId, PackId, CompId)
                        Else
                            dsComp = objGetData.GetRepComponent(CompId)
                        End If
                    End If

                    dsComp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsComp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsComp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "GROUP" Then
                    arrRfilt(a) = "GROUP"
                    GrpId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsGrp = objGetData.GetPivotGroups(GrpId)
                    dsGrp.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsGrp.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsGrp.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable
            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If
                If CompId <> "" Then
                    dsRows = objGetData.GetPivotComponentsProducts(ProdId, PackId, CompId)
                Else
                    dsRows = objGetData.GetPivotProducts(ProdId, PackId, MatId)
                End If

                dsRptAct = objGetData.GetPivotReportData_PROD(ProdTbl, YearId, PackId, MatId, GrpId, CompId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "GROUP" Then
                            strRFilt1 = "SUBGROUPID = " + dsOrder.Tables(0).Rows(a).Item("SUBGROUPID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COMPONENT" Then
                            strRFilt1 = "COMPONENTID = " + dsOrder.Tables(0).Rows(a).Item("COMPONENTID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'strRFilt1 = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then

                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        Else
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT").ToString())
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL").ToString())
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '                'Fact = Convert.ToDecimal(Dr(0).Item("FACTRES") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA").ToString())
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'If count1 <> 0 And count2 <> 0 Then
                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        'Else
                                        '    lbl.Text = FormatNumber(0, 4)
                                        'End If
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    HeaderTdSetting(Td, "130px", "", "1")
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30
                            'Tr.CssClass = "header"

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 <> "" Then
                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                    Else
                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    Else
                                                        dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        Else
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt1 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt1 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'If count1 <> 0 And count2 <> 0 Then
                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    'Else
                                                    '    lbl.Text = FormatNumber(0, 4)
                                                    'End If
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" And arrRfilt(1) <> "GROUP" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "GROUP" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            Else
                                                strRFilt2 = "SUBGROUPID = " + dt2.Rows(b).Item("SUBGROUPID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COMPONENT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            Else
                                                strRFilt2 = "COMPONENTID = " + dt2.Rows(b).Item("COMPONENTID").ToString()
                                            End If
                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            strRFilt2 = strRFilt1
                                        ElseIf arrRfilt(1) = "REGION" Then
                                            strRFilt2 = strRFilt1
                                        End If
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                'imgUp = New ImageButton
                                                'imgDn = New ImageButton
                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                'imgUp.Style.Add("display", "none")
                                                lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                'imgUp.Width = 20
                                                'imgUp.Height = 12
                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                'imgDn.Width = 20
                                                'imgDn.Height = 12
                                                'Td.Controls.Add(imgUp)
                                                'Td.Controls.Add(imgDn)
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "25px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    Else
                                                        dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                        '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        Else
                                                        '            If UnitId = 1 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                        '            ElseIf UnitId = 2 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                        '            ElseIf UnitId = 3 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                        '            ElseIf UnitId = 4 Then
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            Else
                                                        '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                        '            End If
                                                        '        End If
                                                        '    End If
                                                        'Next
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                    'dtRptCols2 = dvRptCols2.ToTable()
                                                    'If strRFilt2 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If

                                                    'If strRFilt2 <> "" Then
                                                    '    dvRptAct.RowFilter = strRFilt2 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'Else
                                                    '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                    'End If
                                                    'dtRptAct = dvRptAct.ToTable()
                                                    'If dtRptAct.Rows.Count > 0 Then
                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        Else
                                                    '    '            If UnitId = 1 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                    '    '            ElseIf UnitId = 2 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                    '    '            ElseIf UnitId = 3 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                    '    '            ElseIf UnitId = 4 Then
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            Else
                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                    '    '            End If
                                                    '    '        End If
                                                    '    '    End If
                                                    '    'Next
                                                    'End If
                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                    'If count1 <> 0 And count2 <> 0 Then
                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                    'Else
                                                    '    lbl.Text = FormatNumber(0, 4)
                                                    'End If
                                                    lbl.Text = ""
                                                End If
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("color", "#660022")
                                                Td.Style.Add("padding-right", "10px")
                                                Td.Style.Add("text-align", "Right")
                                            End If
                                            Td.Font.Size = 9
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = True
                                            Tr.Controls.Add(Td)
                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                        Next

                                        If filterCnt = 2 Then
                                            For i = 1 To dsRows.Tables(0).Rows.Count
                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                dtRptAct = dvRptAct.ToTable()
                                                If dtRptAct.Rows.Count > 0 Then
                                                    Tr = New TableRow
                                                    Tr.CssClass = "Bhavesh"
                                                    Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                    'Tr.Style.Add("display", "none")
                                                    For j = 0 To ColCnt
                                                        If j = 0 Then
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.Style.Add("text-align", "Left")
                                                            Td.Style.Add("padding-left", "50px")
                                                            HeaderTdSetting(Td, "180px", "", "1")
                                                        Else
                                                            Td = New TableCell()
                                                            lbl = New Label
                                                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                Dim ProdCount As New Double
                                                                dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                dtRptAct = dvRptAct.ToTable()
                                                                If dtRptAct.Rows.Count > 0 Then
                                                                    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        Else
                                                                    '            If UnitId = 1 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '            ElseIf UnitId = 2 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '            ElseIf UnitId = 3 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '            ElseIf UnitId = 4 Then
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            Else
                                                                    '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '            End If
                                                                    '        End If
                                                                    '    End If
                                                                    'Next
                                                                End If
                                                                lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                            Else
                                                                Dim count1 As New Double
                                                                Dim count2 As New Double
                                                                Dim diff As New Double
                                                                'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                'dtRptCols1 = dvRptCols1.ToTable()
                                                                'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                'dtRptCols2 = dvRptCols2.ToTable()

                                                                'dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        Else
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If
                                                                'dvRptAct.RowFilter = strRFilt2 + " AND CATEGORYID=" + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                'dtRptAct = dvRptAct.ToTable()
                                                                'If dtRptAct.Rows.Count > 0 Then
                                                                '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        Else
                                                                '    '            If UnitId = 1 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                '    '            ElseIf UnitId = 2 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                '    '            ElseIf UnitId = 3 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                '    '            ElseIf UnitId = 4 Then
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            Else
                                                                '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                '    '            End If
                                                                '    '        End If
                                                                '    '    End If
                                                                '    'Next
                                                                'End If
                                                                'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                'If count1 <> 0 And count2 <> 0 Then
                                                                '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                'Else
                                                                '    lbl.Text = FormatNumber(0, 4)
                                                                'End If
                                                                lbl.Text = ""
                                                            End If
                                                            lbl.CssClass = "Label"
                                                            Td.Controls.Add(lbl)
                                                            Td.CssClass = "AlterNateColor2"
                                                            Td.Style.Add("text-align", "Right")
                                                            Td.Style.Add("padding-right", "10px")
                                                        End If
                                                        Td.Font.Size = 8.5
                                                        Td.Font.Name = "Verdana"
                                                        Td.Font.Bold = False
                                                        Tr.Controls.Add(Td)
                                                    Next
                                                    Tr.Height = 30
                                                    tblCAGR.Controls.Add(Tr)
                                                End If
                                            Next
                                        Else
                                            If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" And arrRfilt(2) <> "GROUP" Then
                                                dv3.RowFilter = strRFilt2
                                            End If
                                            dt3 = dv3.ToTable()
                                            If dt3.Rows.Count > 0 Then
                                                For c = 0 To dt3.Rows.Count - 1
                                                    strRFilt3 = ""
                                                    If arrRfilt(2) = "PRODUCT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        Else
                                                            strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "MATERIAL" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        Else
                                                            strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "GROUP" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        Else
                                                            strRFilt3 = "SUBGROUPID = " + dt3.Rows(c).Item("SUBGROUPID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "PACKAGE" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        Else
                                                            strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COMPONENT" Then
                                                        If strRFilt2 <> "" Then
                                                            strRFilt3 = strRFilt2 + " AND COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        Else
                                                            strRFilt3 = "COMPONENTID = " + dt3.Rows(c).Item("COMPONENTID").ToString()
                                                        End If
                                                    ElseIf arrRfilt(2) = "COUNTRY" Then
                                                        strRFilt3 = strRFilt2
                                                    ElseIf arrRfilt(2) = "REGION" Then
                                                        strRFilt3 = strRFilt2
                                                    End If
                                                    dvRpt.RowFilter = strRFilt3
                                                    dtRpt = dvRpt.ToTable()
                                                    Dim tot3 As New Double
                                                    If dtRpt.Rows.Count > 1 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                'imgUp = New ImageButton
                                                                'imgDn = New ImageButton
                                                                'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                'imgUp.Style.Add("display", "none")
                                                                lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                'imgUp.Width = 20
                                                                'imgUp.Height = 12
                                                                'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                'imgDn.Width = 20
                                                                'imgDn.Height = 12
                                                                'Td.Controls.Add(imgUp)
                                                                'Td.Controls.Add(imgDn)
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        'For l = 0 To dtRptAct.Rows.Count - 1
                                                                        '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                        '        If dtRptAct.Rows(l).Item("FCT").ToString() Then
                                                                        '            If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                        '                If UnitId = 1 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                ElseIf UnitId = 2 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                ElseIf UnitId = 4 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                Else
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                End If
                                                                        '            Else
                                                                        '                If UnitId = 1 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                        '                ElseIf UnitId = 2 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                        '                ElseIf UnitId = 3 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                        '                ElseIf UnitId = 4 Then
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                Else
                                                                        '                    ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                        '                End If
                                                                        '            End If
                                                                        '        End If
                                                                        '    End If
                                                                        'Next
                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double
                                                                    'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                    'dtRptCols1 = dvRptCols1.ToTable()
                                                                    'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                    'dtRptCols2 = dvRptCols2.ToTable()

                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If
                                                                    'dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                    'dtRptAct = dvRptAct.ToTable()
                                                                    'If dtRptAct.Rows.Count > 0 Then
                                                                    '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                    '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                    '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        Else
                                                                    '    '            If UnitId = 1 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                    '    '            ElseIf UnitId = 2 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                    '    '            ElseIf UnitId = 3 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                    '    '            ElseIf UnitId = 4 Then
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            Else
                                                                    '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                    '    '            End If
                                                                    '    '        End If
                                                                    '    '    End If
                                                                    '    'Next
                                                                    'End If
                                                                    'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                    'If count1 <> 0 And count2 <> 0 Then
                                                                    '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                    'Else
                                                                    '    lbl.Text = FormatNumber(0, 4)
                                                                    'End If
                                                                    lbl.Text = ""
                                                                End If
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = True
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If

                                                    For i = 1 To dsRows.Tables(0).Rows.Count
                                                        If strRFilt3 <> "" Then
                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                        Else
                                                            dvRptAct.RowFilter = " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then

                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString()
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then
                                                                        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                            Dim ProdCount As New Double
                                                                            dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString() + " "
                                                                            dtRptAct = dvRptAct.ToTable()
                                                                            If dtRptAct.Rows.Count > 0 Then
                                                                                'For l = 0 To dtRptAct.Rows.Count - 1
                                                                                '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                                '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                                '            If UnitId = 1 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            ElseIf UnitId = 2 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            ElseIf UnitId = 4 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            Else
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            End If
                                                                                '        Else
                                                                                '            If UnitId = 1 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                                '            ElseIf UnitId = 2 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                                '            ElseIf UnitId = 3 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                                '            ElseIf UnitId = 4 Then
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            Else
                                                                                '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                                '            End If
                                                                                '        End If
                                                                                '    End If
                                                                                'Next
                                                                            End If
                                                                            lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                        Else
                                                                            Dim count1 As New Double
                                                                            Dim count2 As New Double
                                                                            Dim diff As New Double
                                                                            'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                                                            'dtRptCols1 = dvRptCols1.ToTable()
                                                                            'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                                                            'dtRptCols2 = dvRptCols2.ToTable()

                                                                            'dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            'dtRptAct = dvRptAct.ToTable()
                                                                            'If dtRptAct.Rows.Count > 0 Then
                                                                            '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '    '            If UnitId = 1 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            ElseIf UnitId = 2 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            ElseIf UnitId = 4 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            Else
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            End If
                                                                            '    '        Else
                                                                            '    '            If UnitId = 1 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '    '            ElseIf UnitId = 2 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '    '            ElseIf UnitId = 3 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '    '            ElseIf UnitId = 4 Then
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            Else
                                                                            '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            End If
                                                                            '    '        End If
                                                                            '    '    End If
                                                                            '    'Next
                                                                            'End If
                                                                            'dvRptAct.RowFilter = strRFilt3 + " AND CATEGORYID = " + dsRows.Tables(0).Rows(i - 1).Item("CATEGORYID").ToString() + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                                                            'dtRptAct = dvRptAct.ToTable()
                                                                            'If dtRptAct.Rows.Count > 0 Then
                                                                            '    'For l = 0 To dtRptAct.Rows.Count - 1
                                                                            '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                                                            '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                                                            '    '            If UnitId = 1 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            ElseIf UnitId = 2 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            ElseIf UnitId = 4 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            Else
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            End If
                                                                            '    '        Else
                                                                            '    '            If UnitId = 1 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                                                            '    '            ElseIf UnitId = 2 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                                                            '    '            ElseIf UnitId = 3 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                                                            '    '            ElseIf UnitId = 4 Then
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            Else
                                                                            '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                                                            '    '            End If
                                                                            '    '        End If
                                                                            '    '    End If
                                                                            '    'Next
                                                                            'End If
                                                                            'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                                                            'If count1 <> 0 And count2 <> 0 Then
                                                                            '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                                                            'Else
                                                                            '    lbl.Text = FormatNumber(0, 4)
                                                                            'End If
                                                                            lbl.Text = ""
                                                                        End If
                                                                        'lbl.Text = FormatNumber(dtRptAct.Rows(0).Item("FCT").ToString(), 2)
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If

                                                    Next
                                                Next
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label

                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                'RowCnt = objGetData.GetReportRegionCount(ddlRegionSet.SelectedValue)
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotProdReportFrameWorkTemp " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub SetPivotGrpReportFrameWorkTemp(ByVal RowCnt As String, ByVal ColCnt As String, ByVal filterCnt As String, ByVal RptID As String)
        Dim objGetData As New Selectdata()
        Dim i As New Integer
        Dim j As New Integer
        Dim HeaderTr As New TableRow()
        Dim HeaderTd As New TableCell()
        Dim Tr As New TableRow()
        Dim Td As New TableCell()
        Dim Path As String = String.Empty
        Dim Link As HyperLink
        Dim hyd As HiddenField
        Dim dsRows As New DataSet
        Dim dsCol As New DataSet
        Dim dsFilter As New DataSet
        Dim Flag As Boolean
        Dim Des As String = String.Empty
        Dim k As Integer
        Dim tblFilter As Table
        Dim trRow As TableRow
        Dim trCol As TableCell
        Dim dv As New DataView
        Dim dvCol As New DataView
        Dim dt As New DataTable
        Dim lbl As Label
        Dim YearId As String = ""
        Dim UnitId As String = ""
        Dim dvRptCols1 As New DataView
        Dim dtRptCols1 As New DataTable
        Dim dvRptCols2 As New DataView
        Dim dtRptCols2 As New DataTable
        Dim dsUnitPref As New DataSet
        Dim dsRep As New DataSet
        'Dim imgUp As New ImageButton
        'Dim imgDn As New ImageButton
        Try
            'Checking for Edit
            If ViewState("Edit") = "Y" Then
                Flag = True
            Else
                Flag = False
            End If

            dsRep = objGetData.GetUserCustomReportsByRptIdTemp(RptID)
            dsUnitPref = objGetData.GetPref(RptID)
            dsRows = objGetData.GetUsersReportRowsTemp(RptID)
            dsCol = objGetData.GetUsersReportColumnsTemp(RptID)
            dsFilter = objGetData.GetUsersReportFiltersTemp(RptID)

            filterCnt = dsFilter.Tables(0).Rows.Count
            ColCnt = dsCol.Tables(0).Rows.Count

            Dim yCnt As New Integer
            For a = 0 To dsCol.Tables(0).Rows.Count - 1
                If dsCol.Tables(0).Rows(a).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    If dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() <> "" Then
                        YearId = YearId + "" + dsCol.Tables(0).Rows(a).Item("COLUMNVALUEID").ToString() + ","
                        yCnt = yCnt + 1
                    End If
                Else
                    yCnt = yCnt + 1
                End If
            Next
            If YearId <> "" Then
                YearId = YearId.Remove(YearId.Length - 1)
            End If

            UnitId = dsRows.Tables(0).Rows(0).Item("UNITID").ToString()

            dvCol = dsCol.Tables(0).DefaultView
            dvRptCols1 = dsCol.Tables(0).DefaultView
            dvRptCols2 = dsCol.Tables(0).DefaultView
            HeaderTr = New TableRow
            For j = 0 To ColCnt
                If j = 0 Then
                    tblFilter = New Table
                    dv = dsFilter.Tables(0).DefaultView
                    For k = 1 To filterCnt
                        trRow = New TableRow
                        trCol = New TableCell
                        HeaderTd = New TableCell()
                        hyd = New HiddenField
                        Link = New HyperLink
                        Link.ID = "Filter_" + k.ToString()
                        hyd.ID = "Filter_ID_" + k.ToString()
                        Link.CssClass = "LinkM"
                        dv.RowFilter = "FILTERSEQUENCE = " + k.ToString()
                        dt = dv.ToTable()
                        If (dt.Rows.Count > 0) Then
                            hyd.Value = dt.Rows(0).Item("USERREPORTFILTERID").ToString()
                            Link.Text = dt.Rows(0).Item("FILTERVALUE").ToString()
                        Else
                            hyd.Value = 0
                        End If

                        GetFilterLink(k, Link, RptID, hyd.ID, hyd.Value)
                        If Link.Text = "" Then
                            Link.Text = "Filter_" + k.ToString()
                        End If
                        trCol.Controls.Add(Link)
                        trCol.Controls.Add(hyd)
                        trRow.Controls.Add(trCol)

                        tblFilter.Controls.Add(trRow)
                        HeaderTd.Controls.Add(tblFilter)
                        HeaderTdSetting(HeaderTd, "150px", "", "1")
                    Next
                Else
                    HeaderTd = New TableCell()
                    hyd = New HiddenField
                    Link = New HyperLink
                    dvCol.RowFilter = "COLUMNSEQUENCE = " + j.ToString()
                    dt = dvCol.ToTable()
                    If (dt.Rows.Count > 0) Then
                        hyd.Value = dt.Rows(0).Item("USERREPORTCOLUMNID").ToString()
                        If dt.Rows(0).Item("COLUMNVALUE").ToString() = "CAGR" Then
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString() + "(" + dt.Rows(0).Item("INPUTVALUE1").ToString() + "/" + dt.Rows(0).Item("INPUTVALUE2").ToString() + ")"
                        Else
                            Des = dt.Rows(0).Item("COLUMNVALUE").ToString()
                        End If
                        Link.Text = Des
                    Else
                        hyd.Value = 0
                    End If

                    Link.ID = "Column_" + j.ToString()
                    hyd.ID = "Column_ID_" + j.ToString()

                    Link.CssClass = "LinkM"
                    GetColLink(j, Link, RptID, hyd.ID, hyd.Value)
                    If Link.Text = "" Then
                        Link.Text = "Column_" + j.ToString()
                    End If
                    HeaderTd.Controls.Add(Link)
                    HeaderTd.Controls.Add(hyd)
                    HeaderTdSetting(HeaderTd, "150px", "", "1")
                End If
                HeaderTd.Font.Size = 8.5
                HeaderTd.Font.Name = "Verdana"
                HeaderTd.Font.Bold = False
                HeaderTr.Controls.Add(HeaderTd)
            Next

            HeaderTr.Height = 30
            tblCAGR.Controls.Add(HeaderTr)

            Dim dsTables As New DataSet
            Dim dvTables As New DataView
            Dim dtTables As New DataTable
            Dim ProdId As String = ""
            'Dim ProdTbl(11) As String
            Dim PackId As String = ""
            Dim dsProd As New DataSet
            Dim dvProd As New DataView
            Dim dtProd As New DataTable
            Dim dsPack As New DataSet
            Dim dvPack As New DataView
            Dim dtPack As New DataTable
            Dim dsOrder As New DataSet()
            Dim funflag As Boolean = False
            Dim MatId As String = ""
            Dim FactId As String = ""
            Dim dsMat As New DataSet
            Dim dsProdMat As New DataSet
            Dim arrRfilt(filterCnt) As String
            Dim CountryId As String = ""
            Dim RegionId As String = ""

            dsTables = objGetData.GetProductDetails(Session("M1SubGroupId"))
            dvTables = dsTables.Tables(0).DefaultView
            Dim ProdTbl(dsTables.Tables(0).Rows.Count - 1) As String

            For a = 0 To dsFilter.Tables(0).Rows.Count - 1
                If dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PRODUCT" Then
                    arrRfilt(a) = "PRODUCT"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        For b = 0 To dsTables.Tables(0).Rows.Count - 1
                            ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                            ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                            RowCnt += 1
                        Next
                        dtTables = dsTables.Tables(0)
                        ProdId = ProdId.Remove(ProdId.Length - 1)
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)

                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                        ProdId = ""
                        For b = 0 To dsProd.Tables(0).Rows.Count - 1
                            ProdId = ProdId + "" + dsProd.Tables(0).Rows(b).Item("ID").ToString() + ","
                        Next
                        ProdId = ProdId.Remove(ProdId.Length - 1)

                    Else
                        ProdId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        dvTables.RowFilter = "ACTUALPRODUCTID=" + ProdId
                        dtTables = dvTables.ToTable()
                        ProdTbl(0) = dtTables.Rows(0).Item("TABLENAME").ToString()
                        RowCnt += 1
                        If PackId <> "" Then
                            dsProd = objGetData.GetPivotPackProducts(ProdId, PackId)
                        Else
                            dsProd = objGetData.GetPivotProductDescription(ProdId)
                        End If
                    End If

                    dsProd.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsProd.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsProd.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "PACKAGE" Then
                    arrRfilt(a) = "PACKAGE"
                    If dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString() = "0" Then
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, "")
                        Else
                            For b = 0 To dsTables.Tables(0).Rows.Count - 1
                                ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                                ProdId = ProdId + "" + dsTables.Tables(0).Rows(b).Item("ACTUALPRODUCTID").ToString() + ","
                                RowCnt += 1
                            Next
                            dtTables = dsTables.Tables(0)
                            ProdId = ProdId.Remove(ProdId.Length - 1)
                            If MatId <> "" Then
                                dsPack = objGetData.GetPivotMatAllPackages(ProdId, MatId)
                            Else
                                dsPack = objGetData.GetPackages(ProdId)
                            End If
                        End If
                        For b = 0 To dsPack.Tables(0).Rows.Count - 1
                            PackId = PackId + "" + dsPack.Tables(0).Rows(b).Item("PACKAGETYPEID").ToString() + ","
                        Next
                        PackId = PackId.Remove(PackId.Length - 1)
                    Else
                        PackId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                        If ProdId <> "" Then
                            dsPack = objGetData.GetPivotProdPackage(ProdId, PackId)
                        Else
                            dsPack = objGetData.GetPivotPackages(PackId)
                        End If
                    End If

                    dsPack.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsPack.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsPack.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "MATERIAL" Then
                    arrRfilt(a) = "MATERIAL"
                    MatId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    If PackId <> "" Then
                        dsMat = objGetData.GetPivotPackMaterials(ProdId, PackId, MatId)
                    Else
                        dsMat = objGetData.GetPivotMaterials(MatId)
                    End If

                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "COUNTRY" Then
                    arrRfilt(a) = "COUNTRY"
                    CountryId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotCountriesByRegion(CountryId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If

                ElseIf dsFilter.Tables(0).Rows(a).Item("FILTERTYPE").ToString().ToUpper() = "REGION" Then
                    arrRfilt(a) = "REGION"
                    RegionId = dsFilter.Tables(0).Rows(a).Item("FILTERVALUEID").ToString()
                    dsMat = objGetData.GetPivotRegion(RegionId)
                    dsMat.Tables(0).TableName = (a + 1).ToString()
                    dsOrder.Tables.Add(dsMat.Tables((a + 1).ToString()).Copy())
                    If a = dsFilter.Tables(0).Rows.Count - 1 Then
                        If dsMat.Tables(0).Rows.Count <> 0 Then
                            funflag = True
                        Else
                            funflag = False
                        End If
                    End If
                End If
            Next

            dv = dsRows.Tables(0).DefaultView
            'SET THE UNIT & SUMMERY PART
            For i = 0 To 0
                Tr = New TableRow()
                For j = 0 To ColCnt
                    Td = New TableCell()
                    lbl = New Label
                    If j = 0 Then
                        HeaderTdSetting(Td, "150px", "", "1")
                        If i = 0 Then
                            lbl.Text = "UNIT"
                        End If
                    Else
                        HeaderTdSetting(Td, "100px", "", "1")
                        If i = 0 Then
                            lbl.ID = "lbl_" + j.ToString()
                            If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() = "Formula" Then
                                lbl.Text = "(%)"
                            Else
                                'If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                'Else
                                '    lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("METRICUNIT").ToString() + ")"
                                'End If
                                lbl.Text = "(" + dsRows.Tables(0).Rows(0).Item("UNITSHRT").ToString() + ")"
                                hidUnitShort.Value = lbl.Text
                            End If
                            Td.Style.Add("text-align", "Center")
                        End If
                    End If

                    Td.Font.Size = 8.5
                    Td.Font.Name = "Verdana"
                    Td.Font.Bold = False
                    Td.Controls.Add(lbl)
                    Tr.Controls.Add(Td)
                Next
                tblCAGR.Controls.Add(Tr)
            Next

            Dim dv1 As New DataView
            Dim dv2 As New DataView
            Dim dv3 As New DataView
            Dim dt1 As New DataTable
            Dim dt2 As New DataTable
            Dim dt3 As New DataTable
            Dim dsRptAct As New DataSet
            Dim dvRptAct As New DataView
            Dim dtRptAct As New DataTable
            Dim strRFilt1 As String = ""
            Dim strRFilt2 As String = ""
            Dim strRFilt3 As String = ""

            If ProdTbl(0) = "" Then
                For b = 0 To dsTables.Tables(0).Rows.Count - 1
                    ProdTbl(b) = dsTables.Tables(0).Rows(b).Item("TABLENAME").ToString()
                    RowCnt += 1
                Next
            End If

            Dim dvRpt As New DataView
            Dim dtRpt As New DataTable
            If YearId = "" Or yCnt <> ColCnt Then
                funflag = False
            End If

            If funflag Then
                If filterCnt = 1 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                ElseIf filterCnt = 2 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                ElseIf filterCnt = 3 Then
                    dv1 = dsOrder.Tables(0).DefaultView
                    dv2 = dsOrder.Tables(1).DefaultView
                    dv3 = dsOrder.Tables(2).DefaultView
                End If

                dsRows = objGetData.GetPivotGroupList(dsRep.Tables(0).Rows(0).Item("REGIONSETID").ToString())
                dsRptAct = objGetData.GetPivotReportData_GRP(ProdTbl, YearId, PackId, MatId, CountryId, RegionId, UnitId, dsTables.Tables(0).Rows.Count)
                dvRptAct = dsRptAct.Tables(0).DefaultView
                dvRpt = dsRptAct.Tables(0).DefaultView
                If dsOrder.Tables(0).Rows.Count <> 0 Then
                    For a = 0 To dsOrder.Tables(0).Rows.Count - 1
                        If arrRfilt(0) = "PRODUCT" Then
                            strRFilt1 = "CATEGORYID = " + dsOrder.Tables(0).Rows(a).Item("CATEGORYID").ToString()
                        ElseIf arrRfilt(0) = "PACKAGE" Then
                            strRFilt1 = "PACKAGETYPEID = " + dsOrder.Tables(0).Rows(a).Item("PACKAGETYPEID").ToString()
                        ElseIf arrRfilt(0) = "MATERIAL" Then
                            strRFilt1 = "MATERIALID = " + dsOrder.Tables(0).Rows(a).Item("MATERIALID").ToString()
                        ElseIf arrRfilt(0) = "COUNTRY" Then
                            'dvRpt.RowFilter = "COUNTRYID = " + dsOrder.Tables(0).Rows(a).Item("COUNTRYID").ToString()
                        ElseIf arrRfilt(0) = "REGION" Then
                            'dvRpt.RowFilter = "REGIONID = " + dsOrder.Tables(0).Rows(a).Item("REGIONID").ToString()
                        End If
                        dvRpt.RowFilter = strRFilt1
                        dtRpt = dvRpt.ToTable()
                        If dtRpt.Rows.Count > 0 Then
                            Tr = New TableRow
                            For j = 0 To ColCnt
                                If j = 0 Then
                                    Td = New TableCell()
                                    lbl = New Label
                                    'imgUp = New ImageButton
                                    'imgDn = New ImageButton
                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString()
                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','-');"
                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString()
                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "','+');"
                                    'imgUp.Style.Add("display", "none")
                                    lbl.Text = dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                                    lbl.CssClass = "Label"
                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                    'imgUp.Width = 20
                                    'imgUp.Height = 12
                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                    'imgDn.Width = 20
                                    'imgDn.Height = 12
                                    'Td.Controls.Add(imgUp)
                                    'Td.Controls.Add(imgDn)
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Left")
                                    Td.Style.Add("padding-left", "5px")
                                    HeaderTdSetting(Td, "180px", "", "1")
                                Else
                                    Td = New TableCell()
                                    HeaderTdSetting(Td, "130px", "", "1")
                                    lbl = New Label
                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                        Dim ProdCount As New Double
                                        If strRFilt1 <> "" Then
                                            dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        Else
                                            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                        End If
                                        dtRptAct = dvRptAct.ToTable()
                                        If dtRptAct.Rows.Count > 0 Then
                                            'For l = 0 To dtRptAct.Rows.Count - 1
                                            '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                            '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        Else
                                            '            If UnitId = 1 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                            '            ElseIf UnitId = 2 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                            '            ElseIf UnitId = 3 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                            '            ElseIf UnitId = 4 Then
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            Else
                                            '                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                            '            End If
                                            '        End If
                                            '    End If
                                            'Next
                                        End If
                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                    Else
                                        Dim count1 As New Double
                                        Dim count2 As New Double
                                        Dim diff As New Double
                                        'dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                                        'dtRptCols1 = dvRptCols1.ToTable()
                                        'dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                                        'dtRptCols2 = dvRptCols2.ToTable()

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'If strRFilt1 <> "" Then
                                        '    dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'Else
                                        '    dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                                        'End If
                                        'dtRptAct = dvRptAct.ToTable()
                                        'If dtRptAct.Rows.Count > 0 Then
                                        '    'For l = 0 To dtRptAct.Rows.Count - 1
                                        '    '    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                                        '    '        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        Else
                                        '    '            If UnitId = 1 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                                        '    '            ElseIf UnitId = 2 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                                        '    '            ElseIf UnitId = 3 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                                        '    '            ElseIf UnitId = 4 Then
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            Else
                                        '    '                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                                        '    '            End If
                                        '    '        End If
                                        '    '    End If
                                        '    'Next
                                        'End If

                                        'diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                                        'If count1 <> 0 And count2 <> 0 Then
                                        '    lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                                        'Else
                                        '    lbl.Text = FormatNumber(0, 4)
                                        'End If
                                        lbl.Text = ""
                                    End If
                                    Td.Controls.Add(lbl)
                                    Td.Style.Add("text-align", "Right")
                                    Td.Style.Add("padding-right", "10px")
                                    'Td.CssClass = "AlterNateColor2"
                                End If
                                Td.Font.Size = 9
                                Td.Font.Name = "Verdana"
                                Td.Font.Bold = True
                                Tr.Controls.Add(Td)
                            Next
                            Tr.Height = 30

                            If filterCnt = 1 Then
                                tblCAGR.Controls.Add(Tr)
                                For i = 1 To dsRows.Tables(0).Rows.Count
                                    If strRFilt1 = "" Then
                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                    Else
                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                    End If
                                    dtRptAct = dvRptAct.ToTable()
                                    If dtRptAct.Rows.Count > 0 Then
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Data" + i.ToString()
                                        'Tr.Style.Add("display", "none")
                                        For j = 0 To ColCnt
                                            If j = 0 Then
                                                Td = New TableCell()
                                                lbl = New Label
                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.Style.Add("text-align", "Left")
                                                Td.Style.Add("padding-left", "50px")
                                                HeaderTdSetting(Td, "180px", "", "1")
                                            Else
                                                Td = New TableCell()
                                                lbl = New Label
                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                    Dim ProdCount As New Double
                                                    If strRFilt1 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt1 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    If dtRptAct.Rows.Count > 0 Then
                                                       
                                                    End If
                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                Else
                                                    Dim count1 As New Double
                                                    Dim count2 As New Double
                                                    Dim diff As New Double
                                                   
                                                    lbl.Text = ""
                                                End If
                                                lbl.CssClass = "Label"
                                                Td.Controls.Add(lbl)
                                                Td.CssClass = "AlterNateColor2"
                                                Td.Style.Add("text-align", "Right")
                                                Td.Style.Add("padding-right", "10px")
                                            End If
                                            Td.Font.Size = 8.5
                                            Td.Font.Name = "Verdana"
                                            Td.Font.Bold = False
                                            Tr.Controls.Add(Td)
                                        Next
                                        Tr.Height = 30
                                        tblCAGR.Controls.Add(Tr)
                                    End If
                                Next
                            Else
                                If arrRfilt(1) <> "REGION" And arrRfilt(1) <> "COUNTRY" Then
                                    dv2.RowFilter = strRFilt1
                                End If
                                dt2 = dv2.ToTable()
                                If dt2.Rows.Count > 0 Then
                                    tblCAGR.Controls.Add(Tr)
                                    For b = 0 To dt2.Rows.Count - 1
                                        strRFilt2 = ""
                                        Tr = New TableRow
                                        Tr.CssClass = "Bhavesh"
                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                        'Tr.Style.Add("display", "none")
                                        If arrRfilt(1) = "PRODUCT" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            Else
                                                strRFilt2 = "CATEGORYID = " + dt2.Rows(b).Item("CATEGORYID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "PACKAGE" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            Else
                                                strRFilt2 = "PACKAGETYPEID = " + dt2.Rows(b).Item("PACKAGETYPEID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "MATERIAL" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1 + " AND MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            Else
                                                strRFilt2 = "MATERIALID = " + dt2.Rows(b).Item("MATERIALID").ToString()
                                            End If

                                        ElseIf arrRfilt(1) = "COUNTRY" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If

                                        ElseIf arrRfilt(1) = "REGION" Then
                                            If strRFilt1 <> "" Then
                                                strRFilt2 = strRFilt1
                                            End If
                                        End If
                                        dvRpt.RowFilter = strRFilt2
                                        dtRpt = dvRpt.ToTable()
                                        If dtRpt.Rows.Count > 0 Then
                                            For j = 0 To ColCnt
                                                If j = 0 Then
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    'imgUp = New ImageButton
                                                    'imgDn = New ImageButton
                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','-');"
                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString()
                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "','+');"
                                                    'imgUp.Style.Add("display", "none")
                                                    lbl.Text = dt2.Rows(b).Item("VALUE").ToString()
                                                    lbl.CssClass = "Label"
                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                    'imgUp.Width = 20
                                                    'imgUp.Height = 12
                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                    'imgDn.Width = 20
                                                    'imgDn.Height = 12
                                                    'Td.Controls.Add(imgUp)
                                                    'Td.Controls.Add(imgDn)
                                                    Td.Controls.Add(lbl)
                                                    Td.Style.Add("text-align", "Left")
                                                    Td.Style.Add("padding-left", "25px")
                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                Else
                                                    Td = New TableCell()
                                                    lbl = New Label
                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                        Dim ProdCount As New Double
                                                        If strRFilt2 <> "" Then
                                                            dvRpt.RowFilter = strRFilt2 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        Else
                                                            dvRpt.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                        End If
                                                        dtRptAct = dvRptAct.ToTable()
                                                        If dtRptAct.Rows.Count > 0 Then
                                                           
                                                        End If
                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                    Else
                                                        Dim count1 As New Double
                                                        Dim count2 As New Double
                                                        Dim diff As New Double
                                                       
                                                        lbl.Text = ""
                                                    End If
                                                    Td.Controls.Add(lbl)
                                                    Td.CssClass = "AlterNateColor2"
                                                    Td.Style.Add("color", "#660022")
                                                    Td.Style.Add("text-align", "Right")
                                                    Td.Style.Add("padding-right", "10px")
                                                End If
                                                Td.Font.Size = 9
                                                Td.Font.Name = "Verdana"
                                                Td.Font.Bold = True
                                                Tr.Controls.Add(Td)
                                            Next
                                            'End If

                                            Tr.Height = 30
                                            tblCAGR.Controls.Add(Tr)
                                            If filterCnt = 2 Then
                                                For i = 1 To dsRows.Tables(0).Rows.Count
                                                    If strRFilt2 <> "" Then
                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                                    Else
                                                        dvRptAct.RowFilter = " SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString()
                                                    End If
                                                    dtRptAct = dvRptAct.ToTable()
                                                    Dim Tot3 As New Double
                                                    If dtRptAct.Rows.Count > 0 Then
                                                        Tr = New TableRow
                                                        Tr.CssClass = "Bhavesh"
                                                        Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Data" + i.ToString()
                                                        'Tr.Style.Add("display", "none")
                                                        For j = 0 To ColCnt
                                                            If j = 0 Then
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.Style.Add("text-align", "Left")
                                                                Td.Style.Add("padding-left", "50px")
                                                                HeaderTdSetting(Td, "180px", "", "1")
                                                            Else
                                                                Td = New TableCell()
                                                                lbl = New Label
                                                                If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                    Dim ProdCount As New Double
                                                                    If strRFilt2 <> "" Then
                                                                        dvRptAct.RowFilter = strRFilt2 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    Else
                                                                        dvRptAct.RowFilter = "SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                    End If
                                                                    dtRptAct = dvRptAct.ToTable()
                                                                    If dtRptAct.Rows.Count > 0 Then

                                                                    End If
                                                                    lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                Else
                                                                    Dim count1 As New Double
                                                                    Dim count2 As New Double
                                                                    Dim diff As New Double

                                                                    lbl.Text = ""
                                                                End If
                                                                lbl.CssClass = "Label"
                                                                Td.Controls.Add(lbl)
                                                                Td.CssClass = "AlterNateColor2"
                                                                Td.Style.Add("text-align", "Right")
                                                                Td.Style.Add("padding-right", "10px")
                                                            End If
                                                            Td.Font.Size = 8.5
                                                            Td.Font.Name = "Verdana"
                                                            Td.Font.Bold = False
                                                            Tr.Controls.Add(Td)
                                                        Next
                                                        Tr.Height = 30
                                                        tblCAGR.Controls.Add(Tr)
                                                    End If
                                                Next
                                            Else
                                                If arrRfilt(2) <> "REGION" And arrRfilt(2) <> "COUNTRY" Then
                                                    dv3.RowFilter = strRFilt2
                                                End If
                                                dt3 = dv3.ToTable()
                                                If dt3.Rows.Count > 0 Then
                                                    For c = 0 To dt3.Rows.Count - 1
                                                        strRFilt3 = ""
                                                        If arrRfilt(2) = "PRODUCT" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("CATEGORYID").ToString()
                                                            Else
                                                                strRFilt3 = "CATEGORYID = " + dt3.Rows(c).Item("CATEGORYID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "PACKAGE" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "PACKAGETYPEID = " + dt3.Rows(c).Item("PACKAGETYPEID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "MATERIAL" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2 + " AND MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString() 'dsOrder.Tables(Convert.ToInt32(q)).Rows(a).Item("PACKAGETYPEID").ToString()
                                                            Else
                                                                strRFilt3 = "MATERIALID = " + dt3.Rows(c).Item("MATERIALID").ToString()
                                                            End If
                                                        ElseIf arrRfilt(2) = "COUNTRY" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2
                                                            End If
                                                        ElseIf arrRfilt(2) = "REGION" Then
                                                            If strRFilt2 <> "" Then
                                                                strRFilt3 = strRFilt2
                                                            End If
                                                        End If
                                                        dvRpt.RowFilter = strRFilt3
                                                        dtRpt = dvRpt.ToTable()
                                                        If dtRpt.Rows.Count > 0 Then
                                                            Tr = New TableRow
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    'imgUp = New ImageButton
                                                                    'imgDn = New ImageButton
                                                                    'imgUp.ID = "Up_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    'imgUp.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','-');"
                                                                    'imgDn.ID = "Dn_Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString()
                                                                    'imgDn.OnClientClick = "javascript:return ShowLines('Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "','+');"
                                                                    'imgUp.Style.Add("display", "none")
                                                                    lbl.Text = dt3.Rows(c).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    'imgUp.ImageUrl = "~/Images/Minus.jpg"
                                                                    'imgUp.Width = 20
                                                                    'imgUp.Height = 12
                                                                    'imgDn.ImageUrl = "~/Images/Plus.jpg"
                                                                    'imgDn.Width = 20
                                                                    'imgDn.Height = 12
                                                                    'Td.Controls.Add(imgUp)
                                                                    'Td.Controls.Add(imgDn)
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "50px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then
                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        lbl.Text = ""
                                                                    End If
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = True
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        End If

                                                        For i = 1 To dsRows.Tables(0).Rows.Count
                                                            Tr = New TableRow
                                                            Tr.CssClass = "Bhavesh"
                                                            Tr.ID = "Layer" + (a + 1).ToString() + "_Layer" + (b + 1).ToString() + "_Layer" + (c + 1).ToString() + "_Data" + i.ToString()
                                                            'Tr.Style.Add("display", "none")
                                                            For j = 0 To ColCnt
                                                                If j = 0 Then
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.Style.Add("text-align", "Left")
                                                                    Td.Style.Add("padding-left", "75px")
                                                                    HeaderTdSetting(Td, "180px", "", "1")
                                                                Else
                                                                    Td = New TableCell()
                                                                    lbl = New Label
                                                                    If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                                                                        Dim ProdCount As New Double
                                                                        dvRptAct.RowFilter = strRFilt3 + " AND SUBGROUPID = " + dsRows.Tables(0).Rows(i - 1).Item("SUBGROUPID").ToString() + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                                                                        dtRptAct = dvRptAct.ToTable()
                                                                        If dtRptAct.Rows.Count > 0 Then

                                                                        End If
                                                                        lbl.Text = "" ' FormatNumber(ProdCount.ToString(), 0)
                                                                    Else
                                                                        Dim count1 As New Double
                                                                        Dim count2 As New Double
                                                                        Dim diff As New Double
                                                                        lbl.Text = ""
                                                                    End If
                                                                    lbl.CssClass = "Label"
                                                                    Td.Controls.Add(lbl)
                                                                    Td.CssClass = "AlterNateColor2"
                                                                    Td.Style.Add("text-align", "Right")
                                                                    Td.Style.Add("padding-right", "10px")
                                                                End If
                                                                Td.Font.Size = 8.5
                                                                Td.Font.Name = "Verdana"
                                                                Td.Font.Bold = False
                                                                Tr.Controls.Add(Td)
                                                            Next
                                                            Tr.Height = 30
                                                            tblCAGR.Controls.Add(Tr)
                                                        Next
                                                    Next
                                                End If
                                            End If
                                        End If
                                    Next
                                End If
                            End If
                        End If
                    Next

                    'Grand Total
                    'Tr = New TableRow
                    'For j = 0 To ColCnt
                    '    If j = 0 Then
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        lbl.Text = "Grand Total" 'dsOrder.Tables(0).Rows(a).Item("VALUE").ToString()
                    '        lbl.CssClass = "Label"
                    '        lbl.Width = 200
                    '        lbl.Style.Add("display", "inline")
                    '        Td.Controls.Add(lbl)
                    '        Td.Style.Add("text-align", "Left")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-left", "5px")
                    '        HeaderTdSetting(Td, "180px", "", "1")
                    '    Else
                    '        Td = New TableCell()
                    '        lbl = New Label
                    '        If dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUETYPE").ToString() <> "Formula" Then
                    '            Dim ProdCount As New Double
                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dsCol.Tables(0).Rows(j - 1).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                ProdCount = ProdCount + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If
                    '            lbl.Text = FormatNumber(ProdCount.ToString(), 0)
                    '        Else
                    '            Dim count1 As New Double
                    '            Dim count2 As New Double
                    '            Dim diff As New Double
                    '            dvRptCols1.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE1").ToString()
                    '            dtRptCols1 = dvRptCols1.ToTable()
                    '            dvRptCols2.RowFilter = "USERREPORTCOLUMNID=" + dsCol.Tables(0).Rows(j - 1).Item("INPUTVALUETYPE2").ToString()
                    '            dtRptCols2 = dvRptCols2.ToTable()

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols1.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count1 = count1 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            'If strRFilt1 <> "" Then
                    '            'dvRptAct.RowFilter = strRFilt1 + " AND YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'Else
                    '            dvRptAct.RowFilter = "YEARID=" + dtRptCols2.Rows(0).Item("COLUMNVALUEID").ToString()
                    '            'End If
                    '            dtRptAct = dvRptAct.ToTable()
                    '            If dtRptAct.Rows.Count > 0 Then
                    '                For l = 0 To dtRptAct.Rows.Count - 1
                    '                    If dtRptAct.Rows(l).Item("FCT").ToString() <> "" Then
                    '                        If dsUnitPref.Tables(0).Rows(0).Item("UNITS").ToString() = 0 Then
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        Else
                    '                            If UnitId = 1 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTWT"), 0)
                    '                            ElseIf UnitId = 2 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTVOL"), 0)
                    '                            ElseIf UnitId = 3 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT") * dsUnitPref.Tables(0).Rows(0).Item("CONVTAREA"), 0)
                    '                            ElseIf UnitId = 4 Then
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            Else
                    '                                count2 = count2 + FormatNumber(dtRptAct.Rows(l).Item("FCT").ToString(), 0)
                    '                            End If
                    '                        End If
                    '                    End If
                    '                Next
                    '            End If

                    '            diff = dtRptCols2.Rows(0).Item("COLUMNVALUEID") - dtRptCols1.Rows(0).Item("COLUMNVALUEID")
                    '            If count1 <> 0 And count2 <> 0 Then
                    '                lbl.Text = FormatNumber((((count2 / count1) ^ (1 / diff)) - 1) * 100, 4)
                    '            Else
                    '                lbl.Text = FormatNumber(0, 4)
                    '            End If
                    '        End If
                    '        'Td.CssClass = "AlterNateColor2"
                    '        Td.Controls.Add(lbl)
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("text-align", "Right")
                    '        Td.Font.Size = 9
                    '        Td.Font.Name = "Verdana"
                    '        Td.Font.Bold = True
                    '        Td.Style.Add("padding-right", "10px")
                    '        HeaderTdSetting(Td, "130px", "", "1")
                    '    End If
                    '    Tr.Controls.Add(Td)
                    'Next
                    'tblCAGR.Controls.Add(Tr)
                Else
                    For i = 1 To dsRows.Tables(0).Rows.Count
                        Tr = New TableRow
                        For j = 0 To ColCnt
                            If j = 0 Then
                                Td = New TableCell()
                                lbl = New Label
                                lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("VALUE").ToString()
                                lbl.CssClass = "Label"
                                Td.Controls.Add(lbl)
                                Td.Style.Add("text-align", "Left")
                                Td.Style.Add("padding-left", "5px")
                                HeaderTdSetting(Td, "180px", "", "1")
                            Else
                                Td = New TableCell()
                                Td.Text = "&nbsp;"
                                HeaderTdSetting(Td, "150px", "", "1")
                                Td.CssClass = "AlterNateColor2"
                            End If
                            Td.Font.Size = 8.5
                            Td.Font.Name = "Verdana"
                            Td.Font.Bold = False
                            Tr.Controls.Add(Td)
                        Next
                        Tr.Height = 30
                        tblCAGR.Controls.Add(Tr)
                    Next
                End If
            Else
                dsRows = objGetData.GetUsersReportRowsTemp(RptID)
                For i = 1 To dsRows.Tables(0).Rows.Count
                    Tr = New TableRow
                    For j = 0 To ColCnt
                        If j = 0 Then
                            Td = New TableCell()
                            lbl = New Label
                            lbl.Text = dsRows.Tables(0).Rows(i - 1).Item("ROWDECRIPTION").ToString()
                            lbl.CssClass = "Label"
                            Td.Controls.Add(lbl)
                            Td.Style.Add("text-align", "Left")
                            Td.Style.Add("padding-left", "5px")
                            HeaderTdSetting(Td, "180px", "", "1")
                        Else
                            Td = New TableCell()
                            Td.Text = "&nbsp;"
                            HeaderTdSetting(Td, "150px", "", "1")
                            Td.CssClass = "AlterNateColor2"
                        End If
                        Td.Font.Size = 8.5
                        Td.Font.Name = "Verdana"
                        Td.Font.Bold = False
                        Tr.Controls.Add(Td)
                    Next
                    Tr.Height = 30
                    tblCAGR.Controls.Add(Tr)
                Next
            End If

        Catch ex As Exception
            lblError.Text = "Error:SetPivotGrpReportFrameWork " + ex.Message.ToString()
        End Try
    End Sub

#End Region

    Protected Sub btnPivotSubmit_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnPivotSubmit.Click
        Try
            CreatePivotReportTemp()
            btnSpecialSubmit.Enabled = True
            EnableDisable(Session("EDType"))

        Catch ex As Exception
            lblError.Text = "Error:btnPivotSubmit_Click " + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnPivotSave_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnPivotSave.Click
        Try
            Dim objUpInsdata As New M1SubUpInsData.UpdateInsert()
            Dim objGetData As New Selectdata()
            If Not objRefresh.IsRefresh Then
                'If objGetData.IsNameExists(txtSpecialReportName.Text.Trim(), hidPropRpt.Value, Session("UserId").ToString()) = False Then
                objUpInsdata.UpdateUserReportNameTemp(txtPivotReportName.Text, hidPropRpt.Value)

                objUpInsdata.SaveUserReports(hidPropRpt.Value)
                objUpInsdata.PrefrencesInsert(hidPropRpt.Value)

                Dim dsRp As New DataSet
                dsRp = objGetData.GetReportDetails(hidPropRpt.Value)
                If dsRp.Tables(0).Rows.Count > 0 Then
                    If Session("EDType") = "ED" Then
                        objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", hidPropRpt.Value, "Pivot", dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "3", hidPropRpt.Value, Session.SessionID)
                    Else
                        objUpInsdata.InsertLog(Session("UserId"), Session("MLogInLog"), "2", hidPropRpt.Value, "Pivot", dsRp.Tables(0).Rows(0).Item("RPTTYPEDES").ToString(), "1", hidPropRpt.Value, Session.SessionID)

                    End If
                End If

                divPivot.Visible = False
                divCreateSpecial.Visible = False
                EnableDisable("")
                GetPCases()
                GetPReportsDetails()
                lnkReports.Text = "Display Proprietary  Report List"
                hidPropRpt.Value = "0"
                Page.ClientScript.RegisterStartupScript(Me.GetType(), "New_WinP", "alert('Pivot Report saved successfully.');", True)
                Session("EDType") = Nothing
            End If
        Catch ex As Exception
            lblError.Text = "Error:btnPivotSave_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub btnPivotCancel_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles btnPivotCancel.Click
        Try
            divPivot.Visible = False
            EnableDisable("")
            btnAddNew.Visible = False
            lnkReports.Text = "Display Proprietary  Report List"
            hidPropRpt.Value = "0"
            Session("EDType") = Nothing
        Catch ex As Exception
            lblError.Text = "Error:btnPivotCancel_Click:" + ex.Message.ToString()
        End Try
    End Sub

    Protected Sub ddlPivotFilters_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPivotFilters.SelectedIndexChanged
        Try
            hidFilterC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub ddlPivotType_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPivotType.SelectedIndexChanged
        Try
            If ddlPivotType.SelectedValue = "REGION" Then
                BindRegionSet()
                PivotrowRegions.Visible = False
                Pivotpackgroup.Visible = False
                PivotprodGroup.Visible = False
                Pivotregionset.Visible = True
            ElseIf ddlPivotType.SelectedValue = "CNTRY" Then
                PivotrowRegions.Visible = True
                Pivotpackgroup.Visible = False
                PivotprodGroup.Visible = False
                Pivotregionset.Visible = True
                BindRegions()
            ElseIf ddlPivotType.SelectedValue = "PACKGRP" Then
                Pivotregionset.Visible = False
                Pivotpackgroup.Visible = True
                PivotprodGroup.Visible = False
                PivotrowRegions.Visible = False
                BindPackGroups()
            ElseIf ddlPivotType.SelectedValue = "PROD" Then
                Pivotpackgroup.Visible = False
                Pivotregionset.Visible = False
                PivotrowRegions.Visible = False
                PivotprodGroup.Visible = False
            ElseIf ddlPivotType.SelectedValue = "PACK" Then
                Pivotpackgroup.Visible = False
                Pivotregionset.Visible = False
                PivotrowRegions.Visible = False
                PivotprodGroup.Visible = False
            ElseIf ddlPivotType.SelectedValue = "MATGRP" Then
                Pivotregionset.Visible = False
                Pivotpackgroup.Visible = False
            ElseIf ddlPivotType.SelectedValue = "MAT" Then
                Pivotregionset.Visible = False
                Pivotpackgroup.Visible = False
                PivotrowRegions.Visible = False
                PivotprodGroup.Visible = False
            ElseIf ddlPivotType.SelectedValue = "GROUP" Then
                PivotrowRegions.Visible = False
                Pivotregionset.Visible = False
                Pivotpackgroup.Visible = False
                BindProdGroups()
                PivotprodGroup.Visible = True
            End If
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub ddlPivotRegion_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPivotRegion.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub

    Protected Sub ddlPivotProdGrp_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPivotProdGrp.SelectedIndexChanged
        Try
            hidRowC.Value = "Y"
        Catch ex As Exception

        End Try
    End Sub
End Class
